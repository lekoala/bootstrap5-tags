{
  "version": 3,
  "sources": ["tags.js"],
  "sourcesContent": ["/**\n * Bootstrap 5 (and 4!) tags\n * https://github.com/lekoala/bootstrap5-tags\n * @license MIT\n */\n\n// #region config\n\n/**\n * @callback EventCallback\n * @param {Event} event\n * @param {Tags} inst\n * @returns {void}\n */\n\n/**\n * @callback ServerCallback\n * @param {Response} response\n * @param {Tags} inst\n * @returns {Promise}\n */\n\n/**\n * @callback ErrorCallback\n * @param {Error} e\n * @param {AbortSignal} signal\n * @param {Tags} inst\n * @returns {void}\n */\n\n/**\n * @callback ModalItemCallback\n * @param {String} value\n * @param {Tags} inst\n * @returns {Promise}\n */\n\n/**\n * @callback RenderCallback\n * @param {Suggestion} item\n * @param {String} label\n * @param {Tags} inst\n * @returns {String}\n */\n\n/**\n * @callback ItemCallback\n * @param {Suggestion} item\n * @param {Tags} inst\n * @returns {void}\n */\n\n/**\n * @callback ValueCallback\n * @param {String} value\n * @param {Tags} inst\n * @returns {void}\n */\n\n/**\n * @callback AddCallback\n * @param {String} value\n * @param {Object} data\n * @param {Tags} inst\n * @returns {void|Boolean}\n */\n\n/**\n * @callback DataCallback\n * @param {*} src\n * @param {Tags} inst\n * @returns {void|Boolean}\n */\n\n/**\n * @callback CreateCallback\n * @param {HTMLOptionElement} option\n * @param {Tags} inst\n * @returns {void}\n */\n\n/**\n * @typedef Config\n * @property {Array<Suggestion|SuggestionGroup>} items Source items\n * @property {Boolean} allowNew Allows creation of new tags\n * @property {Boolean} showAllSuggestions Show all suggestions even if they don't match. Disables validation.\n * @property {String} badgeStyle Color of the badge (color can be configured per option as well)\n * @property {Boolean} allowClear Show a clear icon\n * @property {Boolean} clearEnd Place clear icon at the end\n * @property {Array} selected A list of initially selected values\n * @property {String} regex Regex for new tags\n * @property {Array|String} separator A list (pipe separated) of characters that should act as separator (default is using enter key)\n * @property {Number} max Limit to a maximum of tags (0 = no limit)\n * @property {String} placeholder Provides a placeholder if none are provided as the first empty option\n * @property {String} clearLabel Text as clear tooltip\n * @property {String} searchLabel Default placeholder\n * @property {Boolean} showDropIcon Show dropdown icon\n * @property {Boolean} keepOpen Keep suggestions open after selection, clear on focus out\n * @property {Boolean} allowSame Allow same tags used multiple times\n * @property {String} baseClass Customize the class applied to badges\n * @property {Boolean} addOnBlur Add new tags on blur (only if allowNew is enabled)\n * @property {Boolean} showDisabled Show disabled tags\n * @property {Boolean} hideNativeValidation Hide native validation tooltips\n * @property {Number} suggestionsThreshold Number of chars required to show suggestions\n * @property {Number} maximumItems Maximum number of items to display\n * @property {Boolean} autoselectFirst Always select the first item\n * @property {Boolean} updateOnSelect Update input value on selection (doesn't play nice with autoselectFirst)\n * @property {Boolean} highlightTyped Highlight matched part of the suggestion\n * @property {String} highlightClass Class applied to the mark element\n * @property {Boolean} fullWidth Match the width on the input field\n * @property {Boolean} fixed Use fixed positioning (solve overflow issues)\n * @property {Boolean} fuzzy Fuzzy search\n * @property {Boolean} startsWith Must start with the string. Defaults to false (it matches any position).\n * @property {Boolean} singleBadge Show badge for single elements\n * @property {Array} activeClasses By default: [\"bg-primary\", \"text-white\"]\n * @property {String} labelField Key for the label\n * @property {String} valueField Key for the value\n * @property {Array} searchFields Key for the search\n * @property {String} queryParam Name of the param passed to endpoint (query by default)\n * @property {String} server Endpoint for data provider\n * @property {String} serverMethod HTTP request method for data provider, default is GET\n * @property {String|Object} serverParams Parameters to pass along to the server. You can specify a \"related\" key with the id of a related field.\n * @property {String} serverDataKey By default: data\n * @property {Object} fetchOptions Any other fetch options (https://developer.mozilla.org/en-US/docs/Web/API/fetch#syntax)\n * @property {Boolean} liveServer Should the endpoint be called each time on input\n * @property {Boolean} noCache Prevent caching by appending a timestamp\n * @property {Boolean} allowHtml Allow html in input (can lead to script injection)\n * @property {Function} inputFilter Function to filter input\n * @property {Function} sanitizer Alternative function to sanitize content\n * @property {Number} debounceTime Debounce time for live server\n * @property {String} notFoundMessage Display a no suggestions found message. Leave empty to disable\n * @property {RenderCallback} onRenderItem Callback function that returns the suggestion\n * @property {ItemCallback} onSelectItem Callback function to call on selection\n * @property {ValueCallback} onClearItem Callback function to call on clear\n * @property {CreateCallback} onCreateItem Callback function when an item is created\n * @property {EventCallback} onBlur Callback function on blur\n * @property {DataCallback} onDataLoaded Callback function on data load\n * @property {EventCallback} onFocus Callback function on focus\n * @property {AddCallback} onCanAdd Callback function to validate item. Return false to show validation message.\n * @property {ServerCallback} onServerResponse Callback function to process server response. Must return a Promise\n * @property {ErrorCallback} onServerError Callback function to process server errors.\n * @property {ModalItemCallback} confirmClear Allow modal confirmation of clear. Must return a Promise\n * @property {ModalItemCallback} confirmAdd Allow modal confirmation of add. Must return a Promise\n */\n\n/**\n * @typedef Suggestion\n * @property {String} value Can be overriden by config valueField\n * @property {String} label Can be overriden by config labelField\n * @property {String} title\n * @property {Boolean} disabled\n * @property {Object} data\n * @property {Boolean} [selected]\n * @property {Number} [group_id]\n */\n\n/**\n * @typedef SuggestionGroup\n * @property {String} group\n * @property {Array} items\n */\n\n/**\n * @type {Config}\n */\nconst DEFAULTS = {\n\titems: [],\n\tallowNew: false,\n\tshowAllSuggestions: false,\n\tbadgeStyle: \"primary\",\n\tallowClear: false,\n\tclearEnd: false,\n\tselected: [],\n\tregex: \"\",\n\tseparator: [],\n\tmax: 0,\n\tclearLabel: \"Clear\",\n\tsearchLabel: \"Type a value\",\n\tshowDropIcon: true,\n\tkeepOpen: false,\n\tallowSame: false,\n\tbaseClass: \"\",\n\tplaceholder: \"\",\n\taddOnBlur: false,\n\tshowDisabled: false,\n\thideNativeValidation: false,\n\tsuggestionsThreshold: -1,\n\tmaximumItems: 0,\n\tautoselectFirst: true,\n\tupdateOnSelect: false,\n\thighlightTyped: false,\n\thighlightClass: \"\",\n\tfullWidth: true,\n\tfixed: false,\n\tfuzzy: false,\n\tstartsWith: false,\n\tsingleBadge: false,\n\tactiveClasses: [\"bg-primary\", \"text-white\"],\n\tlabelField: \"label\",\n\tvalueField: \"value\",\n\tsearchFields: [\"label\"],\n\tqueryParam: \"query\",\n\tserver: \"\",\n\tserverMethod: \"GET\",\n\tserverParams: {},\n\tserverDataKey: \"data\",\n\tfetchOptions: {},\n\tliveServer: false,\n\tnoCache: true,\n\tallowHtml: false,\n\tdebounceTime: 300,\n\tnotFoundMessage: \"\",\n\tinputFilter: (str) => str,\n\tsanitizer: (str) => sanitize(str),\n\tonRenderItem: (item, label, inst) => {\n\t\tif (inst.config(\"allowHtml\")) {\n\t\t\treturn label;\n\t\t}\n\t\treturn inst.config(\"sanitizer\")(label);\n\t},\n\tonSelectItem: (item, inst) => {},\n\tonClearItem: (value, inst) => {},\n\tonCreateItem: (option, inst) => {},\n\tonBlur: (event, inst) => {},\n\tonDataLoaded: (src, inst) => {},\n\tonFocus: (event, inst) => {},\n\tonCanAdd: (text, data, inst) => {},\n\tconfirmClear: (item, inst) => Promise.resolve(),\n\tconfirmAdd: (item, inst) => Promise.resolve(),\n\tonServerResponse: (response, inst) => {\n\t\treturn response.json();\n\t},\n\tonServerError: (e, signal, inst) => {\n\t\t// Current version of Firefox rejects the promise with a DOMException\n\t\tif (e.name === \"AbortError\" || signal.aborted) {\n\t\t\treturn;\n\t\t}\n\t\tconsole.error(e);\n\t},\n};\n\n// #endregion\n\n// #region constants\n\nconst CLASS_PREFIX = \"tags-\";\nconst LOADING_CLASS = \"is-loading\";\nconst ACTIVE_CLASS = \"is-active\";\nconst INVALID_CLASS = \"is-invalid\";\nconst MAX_REACHED_CLASS = \"is-max-reached\";\nconst SHOW_CLASS = \"show\";\nconst VALUE_ATTRIBUTE = \"data-value\";\nconst NEXT = \"next\";\nconst PREV = \"prev\";\nconst FOCUS_CLASS = \"form-control-focus\"; // should match form-control:focus\nconst PLACEHOLDER_CLASS = \"form-placeholder-shown\"; // should match :placeholder-shown\nconst DISABLED_CLASS = \"form-control-disabled\"; // should match form-control:disabled\nconst INSTANCE_MAP = new WeakMap();\nlet counter = 0;\n//@ts-ignore\nconst tooltip = window.bootstrap && window.bootstrap.Tooltip;\n\n// #endregion\n\n// #region functions\n\n/**\n * @param {Function} func\n * @param {number} timeout\n * @returns {Function}\n */\nfunction debounce(func, timeout = 300) {\n\tlet timer;\n\treturn (...args) => {\n\t\tclearTimeout(timer);\n\t\ttimer = setTimeout(() => {\n\t\t\t//@ts-ignore\n\t\t\tfunc.apply(this, args);\n\t\t}, timeout);\n\t};\n}\n\n/**\n * @param {string} text\n * @param {HTMLElement} parent\n * @returns {Number}\n */\nfunction calcTextWidth(text, parent = document.body) {\n\tconst span = ce(\"span\");\n\tparent.appendChild(span);\n\tspan.style.fontSize = \"inherit\";\n\tspan.style.height = \"auto\";\n\tspan.style.width = \"auto\";\n\tspan.style.position = \"absolute\";\n\tspan.style.whiteSpace = \"no-wrap\";\n\tspan.innerHTML = sanitize(`${text}`);\n\tconst width = Math.ceil(span.clientWidth);\n\tparent.removeChild(span);\n\t// This can happen if the parent is hidden\n\tif (width <= 20 && parent !== document.body) {\n\t\treturn calcTextWidth(text, document.body);\n\t}\n\treturn width;\n}\n\n/**\n * Determine if a color is a light color\n * @param {string} color\n */\nfunction hexIsLight(color) {\n\tif (!color.includes(\"#\")) {\n\t\treturn true;\n\t}\n\tconst hexColor = +(\n\t\t\"0x\" + color.slice(1).replace(color.length < 5 && /./g, \"$&$&\")\n\t);\n\n\tconst r = hexColor >> 16;\n\tconst g = (hexColor >> 8) & 255;\n\tconst b = hexColor & 255;\n\n\t// HSP equation from http://alienryderflex.com/hsp.html\n\tconst hsp = Math.sqrt(0.299 * (r * r) + 0.587 * (g * g) + 0.114 * (b * b));\n\n\treturn hsp > 127.5;\n}\n\n/**\n * @link https://stackoverflow.com/questions/3043775/how-to-escape-html\n * @param {string} text\n * @returns {string}\n */\nfunction sanitize(text) {\n\treturn text.replace(/[\\x26\\x0A\\<>'\"]/g, function (r) {\n\t\treturn \"&#\" + r.charCodeAt(0) + \";\";\n\t});\n}\n\n/**\n * @param {String} str\n * @returns {String}\n */\nfunction removeDiacritics(str) {\n\treturn str.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\");\n}\n\n/**\n * @param {String|Number} str\n * @returns {String}\n */\nfunction normalize(str) {\n\tif (!str) {\n\t\treturn \"\";\n\t}\n\treturn removeDiacritics(str.toString()).toLowerCase();\n}\n\n/**\n * A simple fuzzy match algorithm that checks if chars are matched\n * in order in the target string\n *\n * @param {String} str\n * @param {String} lookup\n * @returns {Boolean}\n */\nfunction fuzzyMatch(str, lookup) {\n\tif (str.indexOf(lookup) >= 0) {\n\t\treturn true;\n\t}\n\tlet pos = 0;\n\tfor (let i = 0; i < lookup.length; i++) {\n\t\tconst c = lookup[i];\n\t\tif (c === \" \") continue;\n\t\tpos = str.indexOf(c, pos) + 1;\n\t\tif (pos <= 0) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\n/**\n * @param {HTMLElement} item\n */\nfunction hideItem(item) {\n\titem.style.display = \"none\";\n\tattrs(item, {\n\t\t\"aria-hidden\": \"true\",\n\t});\n}\n\n/**\n * @param {HTMLElement} item\n */\nfunction showItem(item) {\n\titem.style.display = \"list-item\";\n\tattrs(item, {\n\t\t\"aria-hidden\": \"false\",\n\t});\n}\n\n/**\n * @param {HTMLElement} el\n * @param {Object} attrs\n */\nfunction attrs(el, attrs) {\n\tfor (const [k, v] of Object.entries(attrs)) {\n\t\tel.setAttribute(k, v);\n\t}\n}\n\n/**\n * @param {HTMLElement} el\n * @param {string} attr\n */\nfunction rmAttr(el, attr) {\n\tif (el.hasAttribute(attr)) {\n\t\tel.removeAttribute(attr);\n\t}\n}\n\n/**\n * Allow 1/0, true/false as strings\n * @param {any} value\n * @returns {Boolean}\n */\nfunction parseBool(value) {\n\treturn (\n\t\t[\"true\", \"false\", \"1\", \"0\", true, false].includes(value) &&\n\t\t!!JSON.parse(value)\n\t);\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K|String} tagName Name of the element\n * @returns {*}\n */\nfunction ce(tagName) {\n\treturn document.createElement(tagName);\n}\n\n/**\n *\n * @param {String} str\n * @param {Array} tokens\n * @returns {Array}\n */\nfunction splitMulti(str, tokens) {\n\tconst tempChar = tokens[0];\n\tlet s = str;\n\tfor (let i = 1; i < tokens.length; i++) {\n\t\ts = s.split(tokens[i]).join(tempChar);\n\t}\n\treturn s.split(tempChar);\n}\n\n/**\n * @param {String} str\n * @param {String} obj\n * @returns {String}\n */\nfunction nested(str, obj = \"window\") {\n\treturn str.split(\".\").reduce((r, p) => r[p], obj);\n}\n\n// #endregion\n\nclass Tags {\n\t/**\n\t * @param {HTMLSelectElement} el\n\t * @param {Object|Config} config\n\t */\n\tconstructor(el, config = {}) {\n\t\tif (!(el instanceof HTMLElement)) {\n\t\t\tconsole.error(\"Invalid element\", el);\n\t\t\treturn;\n\t\t}\n\t\tINSTANCE_MAP.set(el, this);\n\t\tcounter++;\n\t\tthis._selectElement = el;\n\n\t\tthis._configure(config);\n\n\t\t// private vars\n\t\tthis._isMouse = false;\n\t\tthis._keyboardNavigation = false;\n\t\tthis._searchFunc = debounce(() => {\n\t\t\tthis._loadFromServer(true);\n\t\t}, this._config.debounceTime);\n\t\tthis._fireEvents = true;\n\n\t\tthis._configureParent();\n\n\t\t// Create elements\n\t\tthis._holderElement = ce(\"div\"); // this is the one holding the fake input and the dropmenu\n\t\tthis._containerElement = ce(\"div\"); // this is the one for the fake input (labels + input)\n\t\tthis._dropElement = ce(\"ul\"); // this dropdown list\n\t\tthis._searchInput = ce(\"input\"); // the input element\n\t\tthis._holderElement.appendChild(this._containerElement);\n\n\t\t// insert before select, this helps having native validation tooltips positioned properly\n\t\tthis._selectElement.parentElement.insertBefore(\n\t\t\tthis._holderElement,\n\t\t\tthis._selectElement,\n\t\t);\n\n\t\t// Configure them\n\t\tthis._configureHolderElement();\n\t\tthis._configureContainerElement();\n\t\tthis._configureSelectElement();\n\t\tthis._configureSearchInput();\n\t\tthis._configureDropElement();\n\t\tthis.resetState();\n\n\t\t// Rebind handleEvent to make sure the scope will not change\n\t\tthis.handleEvent = (ev) => {\n\t\t\tthis._handleEvent(ev);\n\t\t};\n\n\t\tif (this._config.fixed) {\n\t\t\tdocument.addEventListener(\"scroll\", this, true); // capture input for all scrollables elements\n\t\t\twindow.addEventListener(\"resize\", this);\n\t\t}\n\n\t\t// Search fields with custom label\n\t\tif (\n\t\t\tthis._config.labelField !== \"label\" &&\n\t\t\tthis._config.searchFields.includes(\"label\") &&\n\t\t\tthis._config.searchFields.length === 1\n\t\t) {\n\t\t\tthis._config.searchFields = [this._config.labelField];\n\t\t}\n\n\t\t// Add listeners (remove then on dispose()). See handleEvent.\n\t\t[\"focus\", \"blur\", \"input\", \"keydown\", \"paste\"].forEach((type) => {\n\t\t\tthis._searchInput.addEventListener(type, this);\n\t\t});\n\t\t[\"mousemove\", \"mouseleave\"].forEach((type) => {\n\t\t\tthis._dropElement.addEventListener(type, this);\n\t\t});\n\n\t\tthis.loadData(true);\n\t}\n\n\t// #region Core\n\n\t/**\n\t * Attach to all elements matched by the selector\n\t * @param {string} selector\n\t * @param {Object} opts\n\t * @param {Boolean} reset\n\t */\n\tstatic init(selector = \"select[multiple]\", opts = {}, reset = false) {\n\t\t/**\n\t\t * @type {NodeListOf<HTMLSelectElement>}\n\t\t */\n\t\tconst list = document.querySelectorAll(selector);\n\t\tfor (let i = 0; i < list.length; i++) {\n\t\t\tconst inst = Tags.getInstance(list[i]);\n\t\t\tif (inst && !reset) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (inst) {\n\t\t\t\tinst.dispose();\n\t\t\t}\n\t\t\tnew Tags(list[i], opts);\n\t\t}\n\t}\n\n\t/**\n\t * @param {HTMLSelectElement} el\n\t */\n\tstatic getInstance(el) {\n\t\tif (INSTANCE_MAP.has(el)) {\n\t\t\treturn INSTANCE_MAP.get(el);\n\t\t}\n\t}\n\n\tdispose() {\n\t\t[\"focus\", \"blur\", \"input\", \"keydown\", \"paste\"].forEach((type) => {\n\t\t\tthis._searchInput.removeEventListener(type, this);\n\t\t});\n\t\t[\"mousemove\", \"mouseleave\"].forEach((type) => {\n\t\t\tthis._dropElement.removeEventListener(type, this);\n\t\t});\n\n\t\tif (this._config.fixed) {\n\t\t\tdocument.removeEventListener(\"scroll\", this, true);\n\t\t\twindow.removeEventListener(\"resize\", this);\n\t\t}\n\n\t\t// restore select, remove our custom stuff and unbind parent\n\t\tthis._selectElement.style.display = \"block\";\n\t\tthis._holderElement.parentElement.removeChild(this._holderElement);\n\t\tif (this.parentForm) {\n\t\t\tthis.parentForm.removeEventListener(\"reset\", this);\n\t\t}\n\n\t\tINSTANCE_MAP.delete(this._selectElement);\n\t}\n\n\t/**\n\t * event-polyfill compat / handleEvent is expected on class\n\t * @link https://github.com/lifaon74/events-polyfill/issues/10\n\t * @param {Event} event\n\t */\n\thandleEvent(event) {\n\t\tthis._handleEvent(event);\n\t}\n\n\t/**\n\t * @link https://gist.github.com/WebReflection/ec9f6687842aa385477c4afca625bbf4#handling-events\n\t * @param {Event} event\n\t */\n\t_handleEvent(event) {\n\t\t// debounce scroll and resize\n\t\tconst debounced = [\"scroll\", \"resize\"];\n\t\tif (debounced.includes(event.type)) {\n\t\t\tif (this._timer) window.cancelAnimationFrame(this._timer);\n\t\t\tthis._timer = window.requestAnimationFrame(() => {\n\t\t\t\tthis[`on${event.type}`](event);\n\t\t\t});\n\t\t} else {\n\t\t\tthis[`on${event.type}`](event);\n\t\t}\n\t}\n\n\t/**\n\t * @param {Config|Object} config\n\t */\n\t_configure(config = {}) {\n\t\tthis._config = Object.assign({}, DEFAULTS, {\n\t\t\t// Hide icon by default if no value\n\t\t\tshowDropIcon: this._findOption() ? true : false,\n\t\t});\n\n\t\tconst json = this._selectElement.dataset.config\n\t\t\t? JSON.parse(this._selectElement.dataset.config)\n\t\t\t: {};\n\t\t// Handle options, using arguments first, then json config and then data attr as override\n\t\tconst o = { ...config, ...json, ...this._selectElement.dataset };\n\n\t\t// Typecast provided options based on defaults types\n\t\tfor (const [key, defaultValue] of Object.entries(DEFAULTS)) {\n\t\t\t// Check for undefined keys\n\t\t\tif (key === \"config\" || o[key] === void 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst value = o[key];\n\t\t\tswitch (typeof defaultValue) {\n\t\t\t\tcase \"number\":\n\t\t\t\t\tthis._config[key] = parseInt(value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"boolean\":\n\t\t\t\t\tthis._config[key] = parseBool(value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"string\":\n\t\t\t\t\tthis._config[key] = value.toString();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"object\":\n\t\t\t\t\tthis._config[key] = value;\n\t\t\t\t\tif (typeof value === \"string\") {\n\t\t\t\t\t\tif ([\"{\", \"[\"].includes(value[0])) {\n\t\t\t\t\t\t\t// JSON like string\n\t\t\t\t\t\t\tthis._config[key] = JSON.parse(value);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// CSV or pipe separated string\n\t\t\t\t\t\t\tthis._config[key] = value.split(value.includes(\"|\") ? \"|\" : \",\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"function\":\n\t\t\t\t\t// Find a global function with this name\n\t\t\t\t\tthis._config[key] =\n\t\t\t\t\t\ttypeof value === \"string\"\n\t\t\t\t\t\t\t? value.split(\".\").reduce((r, p) => r[p], window)\n\t\t\t\t\t\t\t: value;\n\t\t\t\t\tif (!this._config[key]) {\n\t\t\t\t\t\tconsole.error(\"Invalid function\", value);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis._config[key] = value;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// Dynamic default values\n\t\tif (!this._config.placeholder) {\n\t\t\tthis._config.placeholder = this._getPlaceholder();\n\t\t}\n\t\tif (this._config.suggestionsThreshold == -1) {\n\t\t\t// if we don't have ajax auto completion, behave like a select by default\n\t\t\tthis._config.suggestionsThreshold = this._config.liveServer ? 1 : 0;\n\t\t}\n\t}\n\n\t/**\n\t * @param {String} k\n\t * @returns {*}\n\t */\n\tconfig(k = null) {\n\t\treturn k ? this._config[k] : this._config;\n\t}\n\n\t/**\n\t * @param {String} k\n\t * @param {*} v\n\t */\n\tsetConfig(k, v) {\n\t\tthis._config[k] = v;\n\t}\n\n\t// #endregion\n\n\t// #region Html\n\n\t/**\n\t * Find overflow parent for positioning\n\t * and bind reset event of the parent form\n\t */\n\t_configureParent() {\n\t\tthis.overflowParent = null;\n\t\tthis.parentForm = this._selectElement.parentElement;\n\t\twhile (this.parentForm) {\n\t\t\tif (this.parentForm.style.overflow === \"hidden\") {\n\t\t\t\tthis.overflowParent = this.parentForm;\n\t\t\t}\n\t\t\tthis.parentForm = this.parentForm.parentElement;\n\t\t\tif (this.parentForm && this.parentForm.nodeName == \"FORM\") {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (this.parentForm) {\n\t\t\tthis.parentForm.addEventListener(\"reset\", this);\n\t\t}\n\t}\n\n\t/**\n\t * @returns {string}\n\t */\n\t_getPlaceholder() {\n\t\t// Use placeholder and data-placeholder in priority\n\t\tif (this._selectElement.hasAttribute(\"placeholder\")) {\n\t\t\treturn this._selectElement.getAttribute(\"placeholder\");\n\t\t}\n\t\tif (this._selectElement.dataset.placeholder) {\n\t\t\treturn this._selectElement.dataset.placeholder;\n\t\t}\n\t\t// Fallback to first option if no value\n\t\tconst firstOption = this._selectElement.querySelector(\"option\");\n\t\tif (!firstOption || !this._config.autoselectFirst) {\n\t\t\treturn \"\";\n\t\t}\n\t\trmAttr(firstOption, \"selected\");\n\t\tfirstOption.selected = false;\n\t\treturn !firstOption.value ? firstOption.textContent : \"\";\n\t}\n\n\t_configureSelectElement() {\n\t\tconst selectEl = this._selectElement;\n\n\t\t// Hiding the select should keep it focusable, otherwise we get this\n\t\t// An invalid form control with name='...' is not focusable.\n\t\t// If it's not focusable, we need to remove the native validation attributes\n\n\t\t// If we use display none, we don't get the focus event\n\t\t// selectEl.style.display = \"none\";\n\n\t\t// If we position it like this, the html5 validation message will not display properly\n\t\tif (this._config.hideNativeValidation) {\n\t\t\t// This position dont break render within input-group and is focusable\n\t\t\tselectEl.style.position = \"absolute\";\n\t\t\tselectEl.style.left = \"-9999px\";\n\t\t} else {\n\t\t\t// Hide but keep it focusable. If 0 height, no native validation message will show\n\t\t\t// It is placed below so that native tooltip is displayed properly\n\t\t\t// Flex basis is required for input-group otherwise it breaks the layout\n\t\t\tselectEl.style.cssText =\n\t\t\t\t\"height:1px;width:1px;opacity:0;padding:0;margin:0;border:0;float:left;flex-basis:100%;min-height:unset;\";\n\t\t}\n\n\t\t// Make sure it's not usable using tab\n\t\tselectEl.tabIndex = -1;\n\n\t\t// No need for custom label click event if select is focusable\n\t\t// const label = document.querySelector('label[for=\"' + selectEl.getAttribute(\"id\") + '\"]');\n\t\t// if (label) {\n\t\t//   label.addEventListener(\"click\", this);\n\t\t// }\n\n\t\t// It can be focused by clicking on the label\n\t\tselectEl.addEventListener(\"focus\", (event) => {\n\t\t\tthis.onclick(event);\n\t\t});\n\n\t\t// When using regular html5 validation, make sure our fake element get the proper class\n\t\tselectEl.addEventListener(\"invalid\", (event) => {\n\t\t\tthis._holderElement.classList.add(INVALID_CLASS);\n\t\t});\n\t}\n\n\t/**\n\t * Configure drop element\n\t * Needs to be called after searchInput is created\n\t */\n\t_configureDropElement() {\n\t\tconst dropEl = this._dropElement;\n\t\tdropEl.classList.add(...[\"dropdown-menu\", `${CLASS_PREFIX}menu`]);\n\t\tdropEl.id = `${CLASS_PREFIX}menu-${counter}`;\n\t\tdropEl.setAttribute(\"role\", \"menu\");\n\n\t\tconst dropStyles = dropEl.style;\n\t\tdropStyles.padding = \"0\"; // avoid ugly space before option\n\t\tdropStyles.maxHeight = \"280px\";\n\t\tif (!this._config.fullWidth) {\n\t\t\tdropStyles.maxWidth = \"360px\";\n\t\t}\n\t\tif (this._config.fixed) {\n\t\t\tdropStyles.position = \"fixed\";\n\t\t}\n\t\tdropStyles.overflowY = \"auto\";\n\t\t// Prevent scrolling the menu from scrolling the page\n\t\t// @link https://developer.mozilla.org/en-US/docs/Web/CSS/overscroll-behavior\n\t\tdropStyles.overscrollBehavior = \"contain\";\n\t\tdropStyles.textAlign = \"unset\"; // otherwise RTL is not good\n\n\t\t// If the mouse was outside, entering remove keyboard nav mode\n\t\tdropEl.addEventListener(\"mouseenter\", (event) => {\n\t\t\tthis._keyboardNavigation = false;\n\t\t});\n\t\tthis._holderElement.appendChild(dropEl);\n\n\t\t// include aria-controls with the value of the id of the suggested list of values.\n\t\tthis._searchInput.setAttribute(\"aria-controls\", dropEl.id);\n\t}\n\n\t_configureHolderElement() {\n\t\tconst holder = this._holderElement;\n\t\tholder.classList.add(...[\"form-control\", \"dropdown\"]);\n\t\t// Reflect size (we must use form-select-xx because we may use form-select) and validation\n\t\t[\"form-select-lg\", \"form-select-sm\", \"is-invalid\", \"is-valid\"].forEach(\n\t\t\t(className) => {\n\t\t\t\tif (this._selectElement.classList.contains(className)) {\n\t\t\t\t\tholder.classList.add(className);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\t// It is really more like a dropdown\n\t\tif (this._config.suggestionsThreshold == 0 && this._config.showDropIcon) {\n\t\t\tholder.classList.add(\"form-select\");\n\t\t}\n\n\t\t// If we have an overflow parent, we can simply inherit styles\n\t\tif (this.overflowParent) {\n\t\t\tholder.style.position = \"inherit\";\n\t\t}\n\t\t// Prevent fixed height due to form-control in bs4\n\t\tholder.style.height = \"auto\";\n\n\t\t// Without this, clicking on a floating label won't always focus properly\n\t\tholder.addEventListener(\"click\", this);\n\t}\n\n\t_configureContainerElement() {\n\t\tthis._containerElement.addEventListener(\"click\", (event) => {\n\t\t\tif (this.isDisabled()) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._searchInput.style.visibility !== \"hidden\") {\n\t\t\t\tthis._searchInput.focus();\n\t\t\t}\n\t\t});\n\n\t\t// Add some extra css to help positioning\n\t\tconst containerStyles = this._containerElement.style;\n\t\tcontainerStyles.display = \"flex\";\n\t\tcontainerStyles.alignItems = \"center\";\n\t\tcontainerStyles.flexWrap = \"wrap\";\n\t}\n\n\t_configureSearchInput() {\n\t\tconst searchInput = this._searchInput;\n\n\t\tsearchInput.type = \"text\";\n\t\tsearchInput.autocomplete = \"off\";\n\t\tsearchInput.spellcheck = false;\n\t\t// note: firefox doesn't support the properties so we use attributes\n\t\t// @link https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-autocomplete\n\t\t// @link https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-expanded\n\t\t// use the aria-expanded state on the element with role combobox to communicate that the list is displayed.\n\t\t// https://developer.mozilla.org/en-US/docs/Web/API/Element/ariaLabel\n\t\tattrs(searchInput, {\n\t\t\t\"aria-autocomplete\": \"list\",\n\t\t\t\"aria-haspopup\": \"menu\",\n\t\t\t\"aria-expanded\": \"false\",\n\t\t\t\"aria-label\": this._config.searchLabel,\n\t\t\trole: \"combobox\",\n\t\t});\n\n\t\tsearchInput.style.cssText =\n\t\t\t\"background-color:transparent;color:currentColor;border:0;padding:0;outline:0;max-width:100%\";\n\t\tthis.resetSearchInput(true);\n\n\t\tthis._containerElement.appendChild(searchInput);\n\t\tthis._rtl =\n\t\t\t(searchInput.dir === \"\" && document.dir === \"rtl\") ||\n\t\t\tsearchInput.dir === \"rtl\";\n\t}\n\n\t// #endregion\n\n\t// #region Events\n\n\tonfocus(event) {\n\t\tif (this._holderElement.classList.contains(FOCUS_CLASS)) {\n\t\t\treturn; // don't trigger multiple focus\n\t\t}\n\t\tthis._holderElement.classList.add(FOCUS_CLASS);\n\t\tthis.showOrSearch();\n\t\tthis._config.onFocus(event, this);\n\t}\n\n\tonblur(event) {\n\t\tconst related = event.relatedTarget;\n\t\t// Clicking on the scroll in a modal blur the element incorrectly\n\t\t// In chrome >= 127, the related target is the dropdown menu\n\t\tif (\n\t\t\tthis._isMouse &&\n\t\t\trelated &&\n\t\t\t(related.classList.contains(\"modal\") ||\n\t\t\t\trelated.classList.contains(`${CLASS_PREFIX}menu`))\n\t\t) {\n\t\t\t// Restore focus\n\t\t\tthis._searchInput.focus();\n\t\t\treturn;\n\t\t}\n\t\tthis.afteronblur(event);\n\t}\n\n\t/**\n\t * This is triggered externally by a document click handler\n\t * Scrolling in the suggestion triggers the blur event and will close the suggestion\n\t * so we cannot rely on the blur event of the input element\n\t * We check for click and focus events (click when clicking outside, focus when tabbing...)\n\t * @param {Event} event\n\t */\n\tafteronblur(event) {\n\t\t// Cancel any pending request\n\t\tif (this._abortController) {\n\t\t\tthis._abortController.abort();\n\t\t}\n\t\tlet clearValidation = true;\n\t\tif (this._config.addOnBlur && this._searchInput.value) {\n\t\t\tclearValidation = this._enterValue();\n\t\t}\n\t\tthis._holderElement.classList.remove(FOCUS_CLASS);\n\t\tthis.hideSuggestions(clearValidation);\n\t\tif (this._fireEvents) {\n\t\t\tconst sel = this.getSelection();\n\t\t\tconst data = {\n\t\t\t\tselection: sel ? sel.dataset.value : null,\n\t\t\t\tinput: this._searchInput.value,\n\t\t\t};\n\t\t\tthis._config.onBlur(event, this);\n\t\t\tthis._selectElement.dispatchEvent(\n\t\t\t\tnew CustomEvent(\"tags.blur\", { bubbles: true, detail: data }),\n\t\t\t);\n\t\t}\n\t}\n\n\tonpaste(ev) {\n\t\t//@ts-ignore\n\t\tconst clipboardData = ev.clipboardData || window.clipboardData;\n\t\tconst data = clipboardData.getData(\"text/plain\").replace(/\\r\\n|\\n/g, \" \");\n\t\t// Deal with copy paste including separators\n\t\tif (data.length > 2 && this._config.separator.length) {\n\t\t\t//@ts-ignore\n\t\t\tconst splitData = splitMulti(data, this._config.separator).filter(\n\t\t\t\t(n) => n,\n\t\t\t);\n\t\t\tif (splitData.length > 1) {\n\t\t\t\tev.preventDefault();\n\t\t\t\tsplitData.forEach((value) => {\n\t\t\t\t\tthis._addPastedValue(value);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t_addPastedValue(value) {\n\t\tlet label = value;\n\t\tlet addData = {};\n\t\tif (!this._config.allowNew) {\n\t\t\tconst sel = this.getSelection();\n\t\t\tif (!sel) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvalue = sel.getAttribute(VALUE_ATTRIBUTE);\n\t\t\tlabel = sel.dataset.label;\n\t\t} else {\n\t\t\taddData.new = 1;\n\t\t}\n\t\tthis._config\n\t\t\t.confirmAdd(value, this)\n\t\t\t.then(() => {\n\t\t\t\tthis._add(label, value, addData);\n\t\t\t})\n\t\t\t.catch(() => {});\n\t\treturn;\n\t}\n\n\toninput(ev) {\n\t\tconst data = this._config.inputFilter(this._searchInput.value);\n\t\tif (data != this._searchInput.value) {\n\t\t\tthis._searchInput.value = data;\n\t\t}\n\n\t\t// Add item if a separator is used\n\t\t// On mobile or copy paste, it can pass multiple chars (eg: when pressing space and it formats the string)\n\t\tif (data) {\n\t\t\tconst lastChar = data.slice(-1);\n\t\t\tif (\n\t\t\t\tthis._config.separator.length &&\n\t\t\t\tthis._config.separator.includes(lastChar)\n\t\t\t) {\n\t\t\t\t// Remove separator even if adding is prevented\n\t\t\t\tthis._searchInput.value = this._searchInput.value.slice(0, -1);\n\t\t\t\tthis._addPastedValue(this._searchInput.value);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Adjust input width to current content\n\t\tsetTimeout(() => {\n\t\t\tthis._adjustWidth();\n\t\t});\n\n\t\t// Check if we should display suggestions\n\t\tthis.showOrSearch();\n\t}\n\n\t/**\n\t * keypress doesn't send arrow keys, so we use keydown\n\t * @param {KeyboardEvent} event\n\t */\n\tonkeydown(event) {\n\t\t// Keycode reference : https://css-tricks.com/snippets/javascript/javascript-keycodes/\n\t\tlet key = event.keyCode || event.key;\n\t\t/**\n\t\t * @type {HTMLInputElement}\n\t\t */\n\t\t// @ts-ignore\n\t\tconst target = event.target;\n\n\t\t// Android virtual keyboard might always return 229\n\t\tif (event.keyCode == 229) {\n\t\t\tkey = target.value.charAt(target.selectionStart - 1).charCodeAt(0);\n\t\t}\n\n\t\t// Keyboard keys\n\t\tswitch (key) {\n\t\t\tcase 13:\n\t\t\tcase \"Enter\":\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis._enterValue();\n\t\t\t\tbreak;\n\t\t\tcase 38:\n\t\t\tcase \"ArrowUp\":\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis._keyboardNavigation = true;\n\t\t\t\tthis._moveSelection(PREV);\n\t\t\t\tbreak;\n\t\t\tcase 40:\n\t\t\tcase \"ArrowDown\":\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis._keyboardNavigation = true;\n\t\t\t\tif (this.isDropdownVisible()) {\n\t\t\t\t\tthis._moveSelection(NEXT);\n\t\t\t\t} else {\n\t\t\t\t\t// show menu regardless of input length\n\t\t\t\t\tthis.showOrSearch(false);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 8:\n\t\t\tcase \"Backspace\":\n\t\t\t\t// If the current item is empty, remove the last one\n\t\t\t\tconst lastItem = this.getLastItem();\n\t\t\t\tif (this._searchInput.value.length === 0 && lastItem) {\n\t\t\t\t\tthis._config\n\t\t\t\t\t\t.confirmClear(lastItem, this)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.removeLastItem();\n\t\t\t\t\t\t\tthis._adjustWidth();\n\t\t\t\t\t\t\tthis.showOrSearch();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => {});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 27:\n\t\t\tcase \"Escape\":\n\t\t\t\tthis._searchInput.focus();\n\t\t\t\tthis.hideSuggestions();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonmousemove(e) {\n\t\tthis._isMouse = true;\n\t\t// Moving the mouse means no longer using keyboard\n\t\tthis._keyboardNavigation = false;\n\t}\n\n\tonmouseleave(e) {\n\t\tthis._isMouse = false;\n\t\t// remove selection\n\t\tthis.removeSelection();\n\t}\n\n\tonscroll(e) {\n\t\tthis._positionMenu();\n\t}\n\n\tonresize(e) {\n\t\tthis._positionMenu();\n\t}\n\n\tonclick(e = null) {\n\t\tif (!this.isSingle() && this.isMaxReached()) {\n\t\t\treturn;\n\t\t}\n\t\t// Focus on input when clicking on element or focusing select\n\t\tthis._searchInput.focus();\n\t}\n\n\tonreset(e) {\n\t\tthis.reset();\n\t}\n\n\t// #endregion\n\n\t/**\n\t * @param {Boolean} init called during init\n\t */\n\tloadData(init = false) {\n\t\tif (Object.keys(this._config.items).length > 0) {\n\t\t\tthis.setData(this._config.items, true);\n\t\t} else {\n\t\t\t// This will setData at the end\n\t\t\tthis.resetSuggestions(true);\n\t\t}\n\n\t\tif (this._config.server) {\n\t\t\tif (this._config.liveServer) {\n\t\t\t\t// No need to load anything since it will happen when typing\n\t\t\t\t// Initial values are loaded from config items or from provided options\n\t\t\t} else {\n\t\t\t\tthis._loadFromServer(!init);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Make sure we have valid selected attributes\n\t */\n\t_setSelectedAttributes() {\n\t\t// we use selectedOptions because single select can have a selected option without a selected attribute if it's the first value\n\t\tconst selectedOptions = this._selectElement.selectedOptions || [];\n\t\tfor (let j = 0; j < selectedOptions.length; j++) {\n\t\t\t// Enforce selected attr for consistency\n\t\t\tif (\n\t\t\t\tselectedOptions[j].value &&\n\t\t\t\t!selectedOptions[j].hasAttribute(\"selected\")\n\t\t\t) {\n\t\t\t\tselectedOptions[j].setAttribute(\"selected\", \"selected\");\n\t\t\t}\n\t\t}\n\t}\n\n\tresetState() {\n\t\tif (this.isDisabled()) {\n\t\t\tthis._holderElement.setAttribute(\"readonly\", \"\");\n\t\t\tthis._searchInput.setAttribute(\"disabled\", \"\");\n\t\t\tthis._holderElement.classList.add(DISABLED_CLASS);\n\t\t} else {\n\t\t\trmAttr(this._holderElement, \"readonly\");\n\t\t\trmAttr(this._searchInput, \"disabled\");\n\t\t\tthis._holderElement.classList.remove(DISABLED_CLASS);\n\t\t}\n\t}\n\n\t/**\n\t * Reset suggestions from select element\n\t * Iterates over option children then calls setData\n\t * @param {Boolean} init called during init\n\t */\n\tresetSuggestions(init = false) {\n\t\tthis._setSelectedAttributes();\n\n\t\tconst convertOption = (option) => {\n\t\t\tconst convertedOption = {\n\t\t\t\tvalue: option.getAttribute(\"value\"),\n\t\t\t\tlabel: option.textContent,\n\t\t\t\tdisabled: option.disabled,\n\t\t\t\t//@ts-ignore\n\t\t\t\tselected: option.selected,\n\t\t\t\ttitle: option.title,\n\t\t\t\tdata: Object.assign(\n\t\t\t\t\t{\n\t\t\t\t\t\tdisabled: option.disabled, // pass as data as well\n\t\t\t\t\t},\n\t\t\t\t\toption.dataset,\n\t\t\t\t),\n\t\t\t};\n\n\t\t\t// Converted option must have required value/label fields to be used\n\t\t\tif (this._config.valueField !== \"value\") {\n\t\t\t\tconvertedOption[this._config.valueField] = convertedOption.value;\n\t\t\t}\n\t\t\tif (this._config.labelField !== \"label\") {\n\t\t\t\tconvertedOption[this._config.labelField] = convertedOption.label;\n\t\t\t}\n\n\t\t\treturn convertedOption;\n\t\t};\n\n\t\tconst suggestions = Array.from(this._selectElement.children)\n\t\t\t.filter(\n\t\t\t\t/**\n\t\t\t\t * @param {HTMLOptionElement|HTMLOptGroupElement} option\n\t\t\t\t */\n\t\t\t\t(option) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\toption.hasAttribute(\"label\") ||\n\t\t\t\t\t\t!option.disabled ||\n\t\t\t\t\t\tthis._config.showDisabled\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t)\n\t\t\t.map(\n\t\t\t\t/**\n\t\t\t\t * @param {HTMLOptionElement|HTMLOptGroupElement} option\n\t\t\t\t */\n\t\t\t\t(option) => {\n\t\t\t\t\tif (option.hasAttribute(\"label\")) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tgroup: option.getAttribute(\"label\"),\n\t\t\t\t\t\t\titems: Array.from(option.children).map((option) => {\n\t\t\t\t\t\t\t\treturn convertOption(option);\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\treturn convertOption(option);\n\t\t\t\t},\n\t\t\t);\n\n\t\tthis.setData(suggestions, init);\n\t}\n\n\t/**\n\t * Try to add the current value\n\t * @returns {Boolean}\n\t */\n\t_enterValue() {\n\t\tconst selection = this.getSelection();\n\t\tif (selection) {\n\t\t\tselection.click();\n\t\t\treturn true;\n\t\t}\n\t\t// We use what is typed if not selected and not empty\n\t\tif (this._config.allowNew && this._searchInput.value) {\n\t\t\tconst text = this._searchInput.value;\n\t\t\tthis._config\n\t\t\t\t.confirmAdd(text, this)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis._add(text, text, { new: 1 });\n\t\t\t\t})\n\t\t\t\t.catch(() => {});\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * @param {Boolean} show Show menu after load. False during init\n\t */\n\t_loadFromServer(show = false) {\n\t\tif (this._abortController) {\n\t\t\tthis._abortController.abort();\n\t\t}\n\t\tthis._abortController = new AbortController();\n\n\t\t// Read data params dynamically as well (eg: for vue JS)\n\t\tlet extraParams = this._selectElement.dataset.serverParams || {};\n\t\tif (typeof extraParams === \"string\") {\n\t\t\textraParams = JSON.parse(extraParams);\n\t\t}\n\t\tconst params = Object.assign({}, this._config.serverParams, extraParams);\n\t\t// Pass current value\n\t\tparams[this._config.queryParam] = this._searchInput.value;\n\t\t// Prevent caching\n\t\tif (this._config.noCache) {\n\t\t\tparams.t = Date.now();\n\t\t}\n\t\t// We have a related field\n\t\tif (params.related) {\n\t\t\t/**\n\t\t\t * @type {HTMLInputElement}\n\t\t\t */\n\t\t\t//@ts-ignore\n\t\t\tconst input = document.getElementById(params.related);\n\t\t\tif (input) {\n\t\t\t\tparams.related = input.value;\n\t\t\t\tconst inputName = input.getAttribute(\"name\");\n\t\t\t\tif (inputName) {\n\t\t\t\t\tparams[inputName] = input.value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst urlParams = new URLSearchParams(params);\n\t\tlet url = this._config.server;\n\t\tconst fetchOptions = Object.assign(this._config.fetchOptions, {\n\t\t\tmethod: this._config.serverMethod || \"GET\",\n\t\t\tsignal: this._abortController.signal,\n\t\t});\n\n\t\tif (fetchOptions.method === \"POST\") {\n\t\t\tfetchOptions.body = urlParams;\n\t\t} else {\n\t\t\turl += `?${urlParams.toString()}`;\n\t\t}\n\n\t\tthis._holderElement.classList.add(LOADING_CLASS);\n\t\tfetch(url, fetchOptions)\n\t\t\t.then((r) => this._config.onServerResponse(r, this))\n\t\t\t.then((suggestions) => {\n\t\t\t\tconst data =\n\t\t\t\t\tnested(this._config.serverDataKey, suggestions) || suggestions;\n\t\t\t\tthis.setData(data, !show);\n\t\t\t\tthis._abortController = null;\n\t\t\t\tif (show) {\n\t\t\t\t\tthis._showSuggestions();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tthis._config.onServerError(e, this._abortController.signal, this);\n\t\t\t})\n\t\t\t.finally((e) => {\n\t\t\t\tthis._holderElement.classList.remove(LOADING_CLASS);\n\t\t\t});\n\t}\n\n\t/**\n\t * Wrapper for the public addItem method that check if the item\n\t * can be added\n\t *\n\t * @param {string} text\n\t * @param {string} value\n\t * @param {object} data\n\t * @returns {HTMLOptionElement|null}\n\t */\n\t_add(text, value = null, data = {}) {\n\t\t// Pass along value in data for canAdd()\n\t\tif (!data.value && value) {\n\t\t\tdata.value = value;\n\t\t}\n\t\tif (!this.canAdd(text, data)) {\n\t\t\treturn null;\n\t\t}\n\t\tconst el = this.addItem(text, value, data);\n\t\tthis._resetHtmlState();\n\t\tif (this._config.keepOpen) {\n\t\t\tthis._showSuggestions();\n\t\t} else {\n\t\t\tthis.resetSearchInput();\n\t\t}\n\n\t\treturn el;\n\t}\n\n\t/**\n\t * @param {HTMLElement} li\n\t * @returns {Boolean}\n\t */\n\t_isItemEnabled(li) {\n\t\tif (li.style.display === \"none\") {\n\t\t\treturn false;\n\t\t}\n\t\tconst fc = li.firstElementChild;\n\t\treturn fc.tagName === \"A\" && !fc.classList.contains(\"disabled\");\n\t}\n\n\t/**\n\t * @param {String} dir\n\t * @param {*|HTMLElement} sel\n\t * @returns {HTMLElement}\n\t */\n\t_moveSelection(dir = NEXT, sel = null) {\n\t\tconst active = this.getSelection();\n\t\tlet s = sel;\n\n\t\t// select first li if visible\n\t\tif (!active) {\n\t\t\t// no active selection, cannot go back\n\t\t\tif (dir === PREV) {\n\t\t\t\treturn s;\n\t\t\t}\n\t\t\t// find first enabled item\n\t\t\tif (!s) {\n\t\t\t\ts = this._dropElement.firstChild;\n\t\t\t\twhile (s && !this._isItemEnabled(s)) {\n\t\t\t\t\ts = s.nextSibling;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst sibling = dir === NEXT ? \"nextSibling\" : \"previousSibling\";\n\n\t\t\t// Iterate over visible li\n\t\t\ts = active.parentNode;\n\t\t\tdo {\n\t\t\t\ts = s[sibling];\n\t\t\t} while (s && !this._isItemEnabled(s));\n\n\t\t\t// We have a new selection\n\t\t\tif (s) {\n\t\t\t\t// Remove classes from current active\n\t\t\t\tactive.classList.remove(...this._activeClasses());\n\t\t\t} else if (active) {\n\t\t\t\t// Use active element as selection\n\t\t\t\ts = active.parentElement;\n\t\t\t}\n\t\t}\n\n\t\tif (s) {\n\t\t\t// Scroll if necessary\n\t\t\tconst selHeight = s.offsetHeight;\n\t\t\tconst selTop = s.offsetTop;\n\t\t\tconst parent = s.parentNode;\n\t\t\tconst parentHeight = parent.offsetHeight;\n\t\t\tconst parentScrollHeight = parent.scrollHeight;\n\t\t\tconst parentTop = parent.offsetTop;\n\n\t\t\t// Reset scroll, this can happen if menu was scrolled then hidden\n\t\t\tif (selHeight === 0) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tparent.scrollTop = 0;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (dir === PREV) {\n\t\t\t\t// Don't use scrollIntoView as it scrolls the whole window\n\t\t\t\t// Avoid minor top scroll due to headers\n\t\t\t\tconst scrollTop = selTop - parentTop > 10 ? selTop - parentTop : 0;\n\t\t\t\tparent.scrollTop = scrollTop;\n\t\t\t} else {\n\t\t\t\t// This is the equivalent of scrollIntoView(false) but only for parent node\n\t\t\t\t// Only scroll if the element is not visible\n\t\t\t\tconst scrollNeeded =\n\t\t\t\t\tselTop + selHeight - (parentHeight + parent.scrollTop);\n\t\t\t\tif (scrollNeeded > 0 && selHeight > 0) {\n\t\t\t\t\tparent.scrollTop = selTop + selHeight - parentHeight + 1;\n\t\t\t\t\t// On last element, make sure we scroll the the bottom\n\t\t\t\t\tif (parent.scrollTop + parentHeight >= parentScrollHeight - 10) {\n\t\t\t\t\t\tparent.scrollTop = selTop - parentTop;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Adjust link\n\t\t\tconst a = s.querySelector(\"a\");\n\t\t\ta.classList.add(...this._activeClasses());\n\t\t\tthis._searchInput.setAttribute(\"aria-activedescendant\", a.id);\n\t\t\tif (this._config.updateOnSelect) {\n\t\t\t\tthis._searchInput.value = a.dataset.label;\n\t\t\t\tthis._adjustWidth();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._searchInput.setAttribute(\"aria-activedescendant\", \"\");\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t * Adjust the field to fit its content and show/hide placeholder if needed\n\t */\n\t_adjustWidth() {\n\t\tthis._holderElement.classList.remove(PLACEHOLDER_CLASS);\n\t\tif (this._searchInput.value) {\n\t\t\tthis._searchInput.size = this._searchInput.value.length;\n\t\t} else {\n\t\t\t// Show the placeholder only if empty\n\t\t\tif (this.getSelectedValues().length) {\n\t\t\t\tthis._searchInput.placeholder = \"\";\n\t\t\t\tthis._searchInput.size = 1;\n\t\t\t} else {\n\t\t\t\tthis._searchInput.size =\n\t\t\t\t\tthis._config.placeholder.length > 0\n\t\t\t\t\t\t? this._config.placeholder.length\n\t\t\t\t\t\t: 1;\n\t\t\t\tthis._searchInput.placeholder = this._config.placeholder;\n\t\t\t\tthis._holderElement.classList.add(PLACEHOLDER_CLASS);\n\t\t\t}\n\t\t}\n\n\t\t// If the string contains ascii chars or strange font, input size may be wrong\n\t\t// We cannot only rely on the size attribute\n\t\tconst v = this._searchInput.value || this._searchInput.placeholder;\n\t\tif (v.length > 0) {\n\t\t\tconst w = calcTextWidth(v, this._holderElement) + 20;\n\t\t\tthis._searchInput.style.width = `${w}px`; // Don't use minWidth as it would prevent using maxWidth\n\t\t}\n\t}\n\n\t/**\n\t * Add suggestions to the drop element\n\t * @param {Array<Suggestion|SuggestionGroup>} suggestions\n\t */\n\t_buildSuggestions(suggestions) {\n\t\twhile (this._dropElement.lastChild) {\n\t\t\tthis._dropElement.removeChild(this._dropElement.lastChild);\n\t\t}\n\t\tlet idx = 0;\n\t\tlet groupId = 1; // start at one, because data-id = \"\" + 0 doesn't do anything\n\t\tfor (let i = 0; i < suggestions.length; i++) {\n\t\t\tconst suggestion = suggestions[i];\n\n\t\t\tif (!suggestion) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Handle optgroups\n\t\t\tif (suggestion[\"group\"] && suggestion[\"items\"]) {\n\t\t\t\tconst newChild = ce(\"li\");\n\t\t\t\tnewChild.setAttribute(\"role\", \"presentation\");\n\t\t\t\tnewChild.dataset.id = \"\" + groupId;\n\t\t\t\tconst newChildSpan = ce(\"span\");\n\t\t\t\tnewChild.append(newChildSpan);\n\t\t\t\tnewChildSpan.classList.add(...[\"dropdown-header\", \"text-truncate\"]);\n\t\t\t\tnewChildSpan.innerHTML = this._config.sanitizer(suggestion[\"group\"]);\n\t\t\t\tthis._dropElement.appendChild(newChild);\n\n\t\t\t\tif (suggestion[\"items\"]) {\n\t\t\t\t\tfor (let j = 0; j < suggestion[\"items\"].length; j++) {\n\t\t\t\t\t\tconst groupSuggestion = suggestion[\"items\"][j];\n\t\t\t\t\t\tgroupSuggestion.group_id = groupId;\n\t\t\t\t\t\tthis._buildSuggestionsItem(suggestion[\"items\"][j], idx);\n\t\t\t\t\t\tidx++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tgroupId++;\n\t\t\t}\n\n\t\t\t//@ts-ignore\n\t\t\tthis._buildSuggestionsItem(suggestion, idx);\n\t\t\tidx++;\n\t\t}\n\n\t\t// Create the not found message\n\t\tif (this._config.notFoundMessage) {\n\t\t\tconst notFound = ce(\"li\");\n\t\t\tnotFound.setAttribute(\"role\", \"presentation\");\n\t\t\tnotFound.classList.add(`${CLASS_PREFIX}not-found`);\n\t\t\t// Actual message is refreshed on typing, but we need item for consistency\n\t\t\tnotFound.innerHTML = `<span class=\"dropdown-item\"></span>`;\n\t\t\tthis._dropElement.appendChild(notFound);\n\t\t}\n\t}\n\n\t/**\n\t * @param {Suggestion} suggestion\n\t * @param {Number} i The global counter\n\t */\n\t_buildSuggestionsItem(suggestion, i) {\n\t\tif (!suggestion[this._config.valueField]) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst value = suggestion[this._config.valueField];\n\t\tconst label = suggestion[this._config.labelField];\n\n\t\tconst textContent = this._config.onRenderItem(suggestion, label, this);\n\n\t\tconst newChild = ce(\"li\");\n\t\t// role must be menuitem when used with menu\n\t\t// see https://github.com/lekoala/bootstrap5-tags/issues/114\n\t\tnewChild.setAttribute(\"role\", \"menuitem\");\n\t\tif (suggestion.group_id) {\n\t\t\tnewChild.setAttribute(\"data-group-id\", `${suggestion.group_id}`);\n\t\t}\n\t\tif (suggestion.title) {\n\t\t\tnewChild.setAttribute(\"title\", suggestion.title);\n\t\t\tnewChild.setAttribute(\"data-bs-placement\", \"left\");\n\t\t}\n\t\tconst newChildLink = ce(\"a\");\n\t\tnewChild.append(newChildLink);\n\t\tnewChildLink.id = `${this._dropElement.id}-${i}`;\n\t\tnewChildLink.classList.add(...[\"dropdown-item\", \"text-truncate\"]);\n\t\tif (suggestion.disabled) {\n\t\t\tnewChildLink.classList.add(...[\"disabled\"]);\n\t\t}\n\t\tnewChildLink.setAttribute(VALUE_ATTRIBUTE, value);\n\t\tnewChildLink.dataset.label = label;\n\n\t\tconst searchData = {};\n\t\tthis._config.searchFields.forEach((sf) => {\n\t\t\tsearchData[sf] = suggestion[sf];\n\t\t});\n\t\tnewChildLink.dataset.searchData = JSON.stringify(searchData);\n\t\tnewChildLink.setAttribute(\"href\", \"#\");\n\t\t// sanitized if needed by onRenderItem\n\t\tnewChildLink.innerHTML = textContent;\n\t\tthis._dropElement.appendChild(newChild);\n\n\t\t// tooltips\n\t\tconst v5 = this._getBootstrapVersion() === 5;\n\t\tif (suggestion.title && tooltip && v5) {\n\t\t\ttooltip.getOrCreateInstance(newChild);\n\t\t}\n\n\t\t// Hover sets active item\n\t\tnewChildLink.addEventListener(\"mouseenter\", (event) => {\n\t\t\t// Don't trigger enter if using arrows\n\t\t\tif (this._keyboardNavigation) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.removeSelection();\n\t\t\tnewChild.querySelector(\"a\").classList.add(...this._activeClasses());\n\t\t});\n\t\tnewChildLink.addEventListener(\"mousedown\", (event) => {\n\t\t\t// Otherwise searchInput would lose focus and close the menu\n\t\t\tevent.preventDefault();\n\t\t});\n\t\tnewChildLink.addEventListener(\"click\", (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\tthis._config\n\t\t\t\t.confirmAdd(value, this)\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis._add(label, value, suggestion.data);\n\t\t\t\t\tthis._config.onSelectItem(suggestion, this);\n\t\t\t\t})\n\t\t\t\t.catch(() => {});\n\t\t});\n\t}\n\n\t/**\n\t * @returns {NodeListOf<HTMLOptionElement>}\n\t */\n\tinitialOptions() {\n\t\treturn this._selectElement.querySelectorAll(\"option[data-init]\");\n\t}\n\n\t/**\n\t * Call this before looping in a list that calls addItem\n\t * This will make sure addItem will not add incorrectly options to the select\n\t */\n\t_removeSelectedAttrs() {\n\t\tthis._selectElement.querySelectorAll(\"option\").forEach((opt) => {\n\t\t\trmAttr(opt, \"selected\");\n\t\t});\n\t}\n\n\treset() {\n\t\tthis.removeAll();\n\n\t\t// Reset doesn't fire change event\n\t\tthis._fireEvents = false;\n\t\tconst opts = this.initialOptions();\n\t\tthis._removeSelectedAttrs();\n\t\tfor (let j = 0; j < opts.length; j++) {\n\t\t\tconst iv = opts[j];\n\t\t\tconst data = Object.assign(\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\tdisabled: iv.hasAttribute(\"disabled\"),\n\t\t\t\t},\n\t\t\t\tiv.dataset,\n\t\t\t);\n\t\t\tthis.addItem(iv.textContent, iv.value, data);\n\t\t}\n\t\tthis._resetHtmlState();\n\t\tthis._fireEvents = true;\n\t}\n\n\t/**\n\t * @param {Boolean} init Pass true during init\n\t */\n\tresetSearchInput(init = false) {\n\t\tthis._searchInput.value = \"\";\n\t\tif (!init) {\n\t\t\tthis._adjustWidth();\n\t\t}\n\n\t\tthis._checkMax();\n\n\t\t// Single select is a special case\n\t\tif (this.isSingle() && !init) {\n\t\t\t//@ts-ignore\n\t\t\tdocument.activeElement.blur();\n\t\t\tthis.hideSuggestions();\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Extra things to do when not during init\n\t\tif (!init) {\n\t\t\tif (!this._shouldShow()) {\n\t\t\t\tthis.hideSuggestions();\n\t\t\t}\n\n\t\t\t// Trigger input even to show suggestions if needed when focused\n\t\t\tif (this._searchInput === document.activeElement) {\n\t\t\t\tthis._searchInput.dispatchEvent(new Event(\"input\"));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * We use visibility instead of display to keep layout intact\n\t */\n\t_checkMax() {\n\t\tif (this.isMaxReached()) {\n\t\t\tthis._holderElement.classList.add(MAX_REACHED_CLASS);\n\t\t\tthis._searchInput.style.visibility = \"hidden\";\n\t\t} else {\n\t\t\tif (this._searchInput.style.visibility == \"hidden\") {\n\t\t\t\tthis._searchInput.style.visibility = \"visible\";\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @returns {Array}\n\t */\n\tgetSelectedValues() {\n\t\t// option[selected] is used rather that selectedOptions as it works more consistently\n\t\t/**\n\t\t * @type {NodeListOf<HTMLOptionElement>}\n\t\t */\n\t\tconst selected = this._selectElement.querySelectorAll(\"option[selected]\");\n\t\treturn Array.from(selected).map((el) => el.value);\n\t}\n\n\t/**\n\t * @returns {Array}\n\t */\n\tgetAvailableValues() {\n\t\t/**\n\t\t * @type {NodeListOf<HTMLOptionElement>}\n\t\t */\n\t\tconst selected = this._selectElement.querySelectorAll(\"option\");\n\t\treturn Array.from(selected).map((el) => el.value);\n\t}\n\n\t/**\n\t * Show suggestions or search them depending on live server\n\t * @param {Boolean} check\n\t */\n\tshowOrSearch(check = true) {\n\t\tif (check && !this._shouldShow()) {\n\t\t\t// focusing should not clear validation\n\t\t\tthis.hideSuggestions(false);\n\t\t\treturn;\n\t\t}\n\t\tif (this._config.liveServer) {\n\t\t\tthis._searchFunc();\n\t\t} else {\n\t\t\tthis._showSuggestions();\n\t\t}\n\t}\n\n\t/**\n\t * The element create with buildSuggestions\n\t * @param {Boolean} clearValidation\n\t */\n\thideSuggestions(clearValidation = true) {\n\t\tthis._dropElement.classList.remove(SHOW_CLASS);\n\t\tattrs(this._searchInput, {\n\t\t\t\"aria-expanded\": \"false\",\n\t\t});\n\t\tthis.removeSelection();\n\t\tif (clearValidation) {\n\t\t\tthis._holderElement.classList.remove(INVALID_CLASS);\n\t\t}\n\t}\n\n\t/**\n\t * Show or hide suggestions\n\t * @param {Boolean} check Show suggestions regardless if shouldShow conditions\n\t * @param {Boolean} clearValidation\n\t */\n\ttoggleSuggestions(check = true, clearValidation = true) {\n\t\tif (this._dropElement.classList.contains(SHOW_CLASS)) {\n\t\t\tthis.hideSuggestions(clearValidation);\n\t\t} else {\n\t\t\tthis.showOrSearch(check);\n\t\t}\n\t}\n\n\t/**\n\t * Do we have enough input to show suggestions ?\n\t * @returns {Boolean}\n\t */\n\t_shouldShow() {\n\t\tif (this.isDisabled() || this.isMaxReached()) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this._searchInput.value.length >= this._config.suggestionsThreshold;\n\t}\n\n\t/**\n\t * The element create with buildSuggestions\n\t */\n\t_showSuggestions() {\n\t\t// Never show suggestions if you cannot add new values\n\t\tif (this._searchInput.style.visibility == \"hidden\") {\n\t\t\treturn;\n\t\t}\n\n\t\tconst lookup = normalize(this._searchInput.value);\n\n\t\tconst valueCounter = {};\n\n\t\t// Filter the list according to search string\n\t\tconst list = this._dropElement.querySelectorAll(\"li\");\n\t\tlet count = 0;\n\t\tlet firstItem = null;\n\t\tlet hasPossibleValues = false;\n\t\tconst visibleGroups = {};\n\t\tfor (let i = 0; i < list.length; i++) {\n\t\t\t/**\n\t\t\t * @type {HTMLLIElement}\n\t\t\t */\n\t\t\tconst item = list[i];\n\t\t\t/**\n\t\t\t * @type {HTMLAnchorElement|HTMLSpanElement}\n\t\t\t */\n\t\t\t//@ts-ignore\n\t\t\tconst link = item.firstElementChild;\n\n\t\t\t// This is the empty result message or a header\n\t\t\tif (link instanceof HTMLSpanElement) {\n\t\t\t\t// We will show it later\n\t\t\t\tif (item.dataset.id) {\n\t\t\t\t\tvisibleGroups[item.dataset.id] = false;\n\t\t\t\t}\n\t\t\t\thideItem(item);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Remove previous selection\n\t\t\tlink.classList.remove(...this._activeClasses());\n\n\t\t\t// Hide selected values\n\t\t\tif (!this._config.allowSame) {\n\t\t\t\tconst v = link.getAttribute(VALUE_ATTRIBUTE);\n\t\t\t\t// Find if the matching option is already selected by index to deal with same values\n\t\t\t\tvalueCounter[v] = valueCounter[v] || 0;\n\t\t\t\tconst opt = this._findOption(\n\t\t\t\t\tlink.getAttribute(VALUE_ATTRIBUTE),\n\t\t\t\t\t\"[selected]\",\n\t\t\t\t\tvalueCounter[v]++,\n\t\t\t\t);\n\t\t\t\tif (opt) {\n\t\t\t\t\thideItem(item);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Check search length since we can trigger dropdown with arrow\n\t\t\tconst showAllSuggestions =\n\t\t\t\tthis._config.showAllSuggestions || lookup.length === 0;\n\t\t\t// Do we find a matching string or do we display immediately ?\n\t\t\tlet isMatched =\n\t\t\t\tlookup.length == 0 && this._config.suggestionsThreshold === 0;\n\t\t\tif (!showAllSuggestions && lookup.length > 0) {\n\t\t\t\t// match on any field\n\t\t\t\tconst searchData = JSON.parse(link.dataset.searchData);\n\t\t\t\tthis._config.searchFields.forEach((sf) => {\n\t\t\t\t\tconst text = normalize(searchData[sf]);\n\t\t\t\t\tlet found = false;\n\t\t\t\t\tif (this._config.fuzzy) {\n\t\t\t\t\t\tfound = fuzzyMatch(text, lookup);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst idx = text.indexOf(lookup);\n\t\t\t\t\t\tfound = this._config.startsWith ? idx === 0 : idx >= 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (found) {\n\t\t\t\t\t\tisMatched = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst selectFirst = isMatched || lookup.length === 0;\n\t\t\tif (showAllSuggestions || isMatched) {\n\t\t\t\tcount++;\n\t\t\t\tshowItem(item);\n\t\t\t\tif (item.dataset.groupId) {\n\t\t\t\t\tvisibleGroups[item.dataset.groupId] = true;\n\t\t\t\t}\n\t\t\t\t// Only select as first item if its matching or no lookup\n\t\t\t\tif (!firstItem && this._isItemEnabled(item) && selectFirst) {\n\t\t\t\t\tfirstItem = item;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tthis._config.maximumItems > 0 &&\n\t\t\t\t\tcount > this._config.maximumItems\n\t\t\t\t) {\n\t\t\t\t\thideItem(item);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\thideItem(item);\n\t\t\t}\n\n\t\t\tif (this._config.highlightTyped) {\n\t\t\t\t// using .textContent removes any html that can be present (eg: mark added through highlightTyped)\n\t\t\t\tconst textContent = link.textContent;\n\t\t\t\tconst idx = normalize(textContent).indexOf(lookup);\n\t\t\t\tconst highlighted =\n\t\t\t\t\ttextContent.substring(0, idx) +\n\t\t\t\t\t`<mark class=\"${this._config.highlightClass}\">${textContent.substring(idx, idx + lookup.length)}</mark>` +\n\t\t\t\t\ttextContent.substring(idx + lookup.length, textContent.length);\n\t\t\t\tlink.innerHTML = highlighted;\n\t\t\t}\n\n\t\t\tif (this._isItemEnabled(item)) {\n\t\t\t\thasPossibleValues = true;\n\t\t\t}\n\t\t}\n\n\t\t// No item and we don't allow new items => error\n\t\tif (\n\t\t\t!this._config.allowNew &&\n\t\t\t!(lookup.length === 0 && !hasPossibleValues)\n\t\t) {\n\t\t\tthis._holderElement.classList.add(INVALID_CLASS);\n\t\t}\n\n\t\t// If we allow new elements, regex validation should happen on canAdd instead\n\t\tif (this._config.allowNew && this._config.regex && this.isInvalid()) {\n\t\t\tthis._holderElement.classList.remove(INVALID_CLASS);\n\t\t}\n\n\t\t// Show all groups with visible values\n\t\tArray.from(list)\n\t\t\t.filter((li) => {\n\t\t\t\treturn li.dataset.id;\n\t\t\t})\n\t\t\t.forEach((li) => {\n\t\t\t\tif (visibleGroups[li.dataset.id] === true) {\n\t\t\t\t\tshowItem(li);\n\t\t\t\t}\n\t\t\t});\n\n\t\tif (hasPossibleValues) {\n\t\t\t// Remove validation message if we show selectable values\n\t\t\tthis._holderElement.classList.remove(INVALID_CLASS);\n\n\t\t\t// Autoselect first\n\t\t\tif (firstItem && this._config.autoselectFirst) {\n\t\t\t\tthis.removeSelection();\n\t\t\t\tthis._moveSelection(NEXT, firstItem);\n\t\t\t}\n\t\t}\n\n\t\t// Remove dropdown if list is empty\n\t\tif (count === 0) {\n\t\t\tif (this._config.notFoundMessage) {\n\t\t\t\t/**\n\t\t\t\t * @type {HTMLElement}\n\t\t\t\t */\n\t\t\t\tconst notFound = this._dropElement.querySelector(\n\t\t\t\t\t`.${CLASS_PREFIX}not-found`,\n\t\t\t\t);\n\t\t\t\tnotFound.style.display = \"block\";\n\t\t\t\tconst notFoundMessage = this._config.notFoundMessage.replace(\n\t\t\t\t\t\"{{tag}}\",\n\t\t\t\t\tthis._searchInput.value,\n\t\t\t\t);\n\t\t\t\tnotFound.innerHTML = `<span class=\"dropdown-item\">${notFoundMessage}</span>`;\n\t\t\t\tthis._showDropdown();\n\t\t\t} else {\n\t\t\t\t// Remove dropdown if not found (do not clear validation)\n\t\t\t\tthis.hideSuggestions(false);\n\t\t\t}\n\t\t} else {\n\t\t\t// Or show it if necessary\n\t\t\tthis._showDropdown();\n\t\t}\n\t}\n\n\t_showDropdown() {\n\t\tconst isVisible = this._dropElement.classList.contains(SHOW_CLASS);\n\t\tif (!isVisible) {\n\t\t\tthis._dropElement.classList.add(SHOW_CLASS);\n\t\t\tattrs(this._searchInput, {\n\t\t\t\t\"aria-expanded\": \"true\",\n\t\t\t});\n\t\t}\n\t\tthis._positionMenu(isVisible);\n\t}\n\n\t/**\n\t * @param {Boolean} wasVisible\n\t */\n\t_positionMenu(wasVisible = false) {\n\t\tconst isRTL = this._rtl;\n\t\tconst fixed = this._config.fixed;\n\t\tconst fullWidth = this._config.fullWidth;\n\t\tconst bounds = this._searchInput.getBoundingClientRect();\n\t\tconst holderBounds = this._holderElement.getBoundingClientRect();\n\n\t\tlet left = 0;\n\t\tlet top = 0;\n\n\t\tif (fixed) {\n\t\t\t// In full width, use holder as left reference, otherwise use input\n\t\t\tif (fullWidth) {\n\t\t\t\tleft = holderBounds.x;\n\t\t\t\ttop = holderBounds.y + holderBounds.height + 2; // 2px offset\n\t\t\t} else {\n\t\t\t\tleft = bounds.x;\n\t\t\t\ttop = bounds.y + bounds.height;\n\t\t\t}\n\t\t} else {\n\t\t\t// When positioning is not fixed, we leave it up to the browser\n\t\t\t// it may not work in complex situations with scrollable overflows, etc\n\t\t\tif (fullWidth) {\n\t\t\t\t// Stick it at the start\n\t\t\t\tleft = 0;\n\t\t\t\t// Move it below\n\t\t\t\ttop = holderBounds.height + 2; // 2px offset\n\t\t\t} else {\n\t\t\t\t// Position next to input (offsetLeft != bounds.x)\n\t\t\t\tleft = this._searchInput.offsetLeft;\n\t\t\t\ttop = this._searchInput.offsetHeight + this._searchInput.offsetTop;\n\t\t\t}\n\t\t}\n\n\t\t// Align end\n\t\tif (isRTL && !fullWidth) {\n\t\t\tleft -= this._dropElement.offsetWidth - bounds.width;\n\t\t}\n\n\t\t// Horizontal overflow\n\t\tif (!fullWidth) {\n\t\t\tconst w = Math.min(window.innerWidth, document.body.offsetWidth);\n\t\t\tconst hdiff = isRTL\n\t\t\t\t? bounds.x + bounds.width - this._dropElement.offsetWidth - 1\n\t\t\t\t: w - 1 - (bounds.x + this._dropElement.offsetWidth);\n\t\t\tif (hdiff < 0) {\n\t\t\t\tleft = isRTL ? left - hdiff : left + hdiff;\n\t\t\t}\n\t\t}\n\n\t\t// Use full holder width\n\t\tif (fullWidth) {\n\t\t\tthis._dropElement.style.width = `${this._holderElement.offsetWidth}px`;\n\t\t}\n\n\t\tif (!wasVisible) {\n\t\t\t// Reset any height overflow adjustement\n\t\t\tthis._dropElement.style.transform = \"unset\";\n\t\t}\n\n\t\tObject.assign(this._dropElement.style, {\n\t\t\t// Position element\n\t\t\tleft: `${left}px`,\n\t\t\ttop: `${top}px`,\n\t\t});\n\n\t\t// Overflow height\n\t\tconst dropBounds = this._dropElement.getBoundingClientRect();\n\t\tconst h = window.innerHeight;\n\n\t\t// We display above input if it overflows\n\t\tif (\n\t\t\tdropBounds.y + dropBounds.height > h ||\n\t\t\tthis._dropElement.style.transform.includes(\"translateY\")\n\t\t) {\n\t\t\t// We need to add the offset twice\n\t\t\tconst topOffset = fullWidth ? holderBounds.height + 4 : bounds.height;\n\t\t\t// In chrome, we need 100.1% to avoid blurry text\n\t\t\t// @link https://stackoverflow.com/questions/32034574/font-looks-blurry-after-translate-in-chrome\n\t\t\tthis._dropElement.style.transform = `translateY(calc(-100.1% - ${topOffset}px))`;\n\t\t}\n\t}\n\n\t/**\n\t * @returns {Number}\n\t */\n\t_getBootstrapVersion() {\n\t\tlet ver = 5;\n\t\t// If we have jQuery and the tooltip plugin for BS4\n\t\t//@ts-ignore\n\t\tconst jq = window.jQuery;\n\t\tif (jq && jq.fn.tooltip && jq.fn.tooltip.Constructor) {\n\t\t\tver = parseInt(jq.fn.tooltip.Constructor.VERSION.charAt(0));\n\t\t}\n\t\treturn ver;\n\t}\n\n\t/**\n\t * Find if label is already selected (based on attribute)\n\t * @param {string} text\n\t * @returns {Boolean}\n\t */\n\t_isSelected(text) {\n\t\tconst arr = Array.from(this._selectElement.querySelectorAll(\"option\"));\n\t\tconst selOpt = arr.find(\n\t\t\t(el) => el.textContent == text && el.getAttribute(\"selected\"),\n\t\t);\n\t\treturn selOpt ? true : false;\n\t}\n\n\t/**\n\t * Find if label is already selectable (based on attribute)\n\t * @param {string} text\n\t * @param {Object} data\n\t * @returns {Boolean}\n\t */\n\t_isSelectable(text, data) {\n\t\tconst arr = Array.from(this._selectElement.querySelectorAll(\"option\"));\n\t\tconst opts = data.value\n\t\t\t? arr.filter((el) => el.value == data.value)\n\t\t\t: arr.filter((el) => el.textContent == text);\n\t\t// Only consider actual <option> in the select\n\t\tif (opts.length > 0) {\n\t\t\tconst freeOpt = opts.find((opt) => !opt.getAttribute(\"selected\"));\n\t\t\tif (!freeOpt) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\t/**\n\t * Find if label is selectable (based on attribute)\n\t * This only works for provided items\n\t * @param {string} text\n\t * @returns {Boolean}\n\t */\n\thasItem(text) {\n\t\tfor (let item of this._config.items) {\n\t\t\tconst items = item[\"items\"] || [item];\n\t\t\tfor (let si of items) {\n\t\t\t\tif (si[this._config.labelField] == text) return true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * This only works for provided items\n\t * @param {string} value\n\t * @returns {Object|null}\n\t */\n\tgetItem(value) {\n\t\tfor (let item of this._config.items) {\n\t\t\tconst items = item[\"items\"] || [item];\n\t\t\tfor (let si of items) {\n\t\t\t\tif (si[this._config.valueField] == value) return si;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Checks if value matches a configured regex\n\t * @param {string} value\n\t * @returns {Boolean}\n\t */\n\t_validateRegex(value) {\n\t\tconst regex = new RegExp(this._config.regex.trim());\n\t\treturn regex.test(value);\n\t}\n\n\t/**\n\t * @returns {HTMLElement}\n\t */\n\tgetSelection() {\n\t\treturn this._dropElement.querySelector(`a.${ACTIVE_CLASS}`);\n\t}\n\n\tremoveSelection() {\n\t\tconst selection = this.getSelection();\n\t\tif (selection) {\n\t\t\tselection.classList.remove(...this._activeClasses());\n\t\t}\n\t}\n\n\t/**\n\t * @returns {Array}\n\t */\n\t_activeClasses() {\n\t\treturn [...this._config.activeClasses, ...[ACTIVE_CLASS]];\n\t}\n\n\t/**\n\t * @deprecated since 1.5\n\t * @returns {HTMLElement}\n\t */\n\tgetActiveSelection() {\n\t\treturn this.getSelection();\n\t}\n\n\t/**\n\t * @deprecated since 1.5\n\t */\n\tremoveActiveSelection() {\n\t\treturn this.removeSelection();\n\t}\n\n\t/**\n\t * Remove all items\n\t */\n\tremoveAll() {\n\t\tconst items = this.getSelectedValues();\n\t\titems.forEach((item) => {\n\t\t\tconst res = this.removeItem(item, true);\n\t\t});\n\t\tthis._adjustWidth();\n\t}\n\n\t/**\n\t * @param {Boolean} noEvents\n\t */\n\tremoveLastItem(noEvents = false) {\n\t\tconst lastItem = this.getLastItem();\n\t\tif (lastItem) {\n\t\t\tthis.removeItem(lastItem, noEvents);\n\t\t}\n\t}\n\n\tgetLastItem() {\n\t\tconst items = this._containerElement.querySelectorAll(\n\t\t\t`span.${CLASS_PREFIX}badge`,\n\t\t);\n\t\tif (!items.length) {\n\t\t\treturn;\n\t\t}\n\t\tconst lastItem = items[items.length - 1];\n\t\treturn lastItem.getAttribute(VALUE_ATTRIBUTE);\n\t}\n\n\tdisable() {\n\t\tthis._selectElement.setAttribute(\"disabled\", \"\");\n\t\tthis.resetState();\n\t}\n\n\tenable() {\n\t\trmAttr(this._selectElement, \"disabled\");\n\t\tthis.resetState();\n\t}\n\n\t/**\n\t * @returns {Boolean}\n\t */\n\tisDisabled() {\n\t\treturn (\n\t\t\tthis._selectElement.hasAttribute(\"disabled\") ||\n\t\t\tthis._selectElement.disabled ||\n\t\t\tthis._selectElement.hasAttribute(\"readonly\")\n\t\t);\n\t}\n\n\t/**\n\t * @returns {Boolean}\n\t */\n\tisDropdownVisible() {\n\t\treturn this._dropElement.classList.contains(SHOW_CLASS);\n\t}\n\n\t/**\n\t * @returns {Boolean}\n\t */\n\tisInvalid() {\n\t\treturn this._holderElement.classList.contains(INVALID_CLASS);\n\t}\n\n\t/**\n\t * @returns {Boolean}\n\t */\n\tisSingle() {\n\t\treturn !this._selectElement.hasAttribute(\"multiple\");\n\t}\n\n\t/**\n\t * @returns {Boolean}\n\t */\n\tisMaxReached() {\n\t\treturn (\n\t\t\tthis._config.max && this.getSelectedValues().length >= this._config.max\n\t\t);\n\t}\n\n\t/**\n\t * Check if item can be added\n\t * @param {string} text\n\t * @param {Object} data\n\t * @returns {Boolean}\n\t */\n\tcanAdd(text, data = {}) {\n\t\tconst reason = this.cannotAddReason(text, data);\n\t\tif (reason === \"ok\") {\n\t\t\treturn true;\n\t\t}\n\t\tif (reason.includes(\"invalid-\")) {\n\t\t\tthis._holderElement.classList.add(INVALID_CLASS);\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns why item cannot be added\n\t * @param {string} text\n\t * @param {Object} data\n\t * @returns {string}\n\t */\n\tcannotAddReason(text, data = {}) {\n\t\tif (!text) {\n\t\t\treturn \"no-text\";\n\t\t}\n\t\t// data.new means this is a new item created by this component\n\t\tif (data.new && !this._config.allowNew) {\n\t\t\treturn \"not-allow-new\";\n\t\t}\n\t\t// not a new item, but it doesn't have this item\n\t\tif (!data.new && !this._config.liveServer && !this.hasItem(text)) {\n\t\t\treturn \"no-item\";\n\t\t}\n\t\tif (this.isDisabled()) {\n\t\t\treturn \"is-disabled\";\n\t\t}\n\t\t// Check already selected input (single will replace, so never return false if selected)\n\t\tif (!this.isSingle() && !this._config.allowSame) {\n\t\t\t// Check if value is selected\n\t\t\tif (data.new) {\n\t\t\t\tif (this._isSelected(text)) {\n\t\t\t\t\treturn \"already-selected\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!this._isSelectable(text, data)) {\n\t\t\t\t\treturn \"not-selectable\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this.isMaxReached()) {\n\t\t\treturn \"max-reached\";\n\t\t}\n\t\t// Check for regex on new input\n\t\tif (this._config.regex && data.new && !this._validateRegex(text)) {\n\t\t\treturn \"invalid-regex\";\n\t\t}\n\t\t// Check for custom validation\n\t\tif (\n\t\t\tthis._config.onCanAdd &&\n\t\t\tthis._config.onCanAdd(text, data, this) === false\n\t\t) {\n\t\t\treturn \"invalid-can-add\";\n\t\t}\n\t\treturn \"ok\";\n\t}\n\n\tgetData() {\n\t\treturn this._config.items;\n\t}\n\n\t/**\n\t * Set data\n\t * @param {Array<Suggestion|SuggestionGroup>|Object} src An array of items or a value:label object\n\t * @param {Boolean} init called during init\n\t */\n\tsetData(src, init = false) {\n\t\t// Prevent changes event due to addItem\n\t\tthis._fireEvents = false;\n\n\t\t// Convert value:label to array\n\t\tif (!Array.isArray(src)) {\n\t\t\tsrc = Object.entries(src).map(([value, label]) => ({ value, label }));\n\t\t}\n\n\t\t// If not passed in config\n\t\tif (this._config.items != src) {\n\t\t\tthis._config.items = src;\n\t\t}\n\n\t\t// Track initial selection in case of reset\n\t\tif (init) {\n\t\t\t// addItem will add attribute back\n\t\t\tthis._removeSelectedAttrs();\n\t\t\tconst flatSrc = src.reduce((a, b) => {\n\t\t\t\treturn a.concat(b.group ? b.items : [b]);\n\t\t\t}, []);\n\t\t\tflatSrc.forEach((suggestion) => {\n\t\t\t\tconst value = suggestion[this._config.valueField];\n\t\t\t\tconst label = suggestion[this._config.labelField];\n\n\t\t\t\tif (!value) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Selection on item only matters on init\n\t\t\t\tif (suggestion.selected || this._config.selected.includes(value)) {\n\t\t\t\t\tconst added = this.addItem(label, value, suggestion.data);\n\t\t\t\t\t// Add attribute to actual option to allow for same options being selected\n\t\t\t\t\tif (added) {\n\t\t\t\t\t\tadded.setAttribute(\"data-init\", \"true\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis._buildSuggestions(src);\n\t\tthis._resetHtmlState();\n\t\tthis._fireEvents = true;\n\n\t\tthis._config.onDataLoaded(src, this);\n\t\tthis._selectElement.dispatchEvent(\n\t\t\tnew CustomEvent(\"tags.loaded\", { bubbles: true, detail: src }),\n\t\t);\n\t}\n\n\t/**\n\t * Keep in mind that we can have the same value for multiple options\n\t * @param {*} value\n\t * @param {string} mode\n\t * @param {number} counter\n\t * @returns {HTMLOptionElement|null}\n\t */\n\t_findOption(value = null, mode = \"\", counter = 0) {\n\t\t// escape invalid characters for HTML attributes: \\' \" = < > ` &.'\n\t\tconst val = value === null ? \"\" : `[value=\"${CSS.escape(value)}\"]`;\n\t\tconst sel = `option${val}${mode}`;\n\t\tconst opts = this._selectElement.querySelectorAll(sel);\n\t\t//@ts-ignore\n\t\treturn opts[counter] || null;\n\t}\n\n\t/**\n\t * This works like addItem, but only for existing values\n\t * @param {string} value\n\t * @param {object} data\n\t * @return {HTMLOptionElement|null} The selected option or null\n\t */\n\tsetItem(value, data = {}) {\n\t\tlet addedItem = null;\n\n\t\tif (!this._config.allowSame) {\n\t\t\tlet existingOpt = this._findOption(value, \"[selected]\");\n\t\t\tif (existingOpt) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tlet opt = this._findOption(value, \":not([selected])\");\n\t\tif (opt) {\n\t\t\taddedItem = this.addItem(opt.textContent, opt.value, data);\n\t\t} else {\n\t\t\t// Look also in items if opt is not found\n\t\t\tlet item = this.getItem(value);\n\t\t\tif (item) {\n\t\t\t\tconst value = item[this._config.valueField];\n\t\t\t\tconst label = item[this._config.labelField];\n\t\t\t\taddedItem = this.addItem(label, value, data);\n\t\t\t}\n\t\t}\n\t\t// Maybe we need to whole _resetHtmlState thing\n\t\tthis._adjustWidth();\n\t\tthis._checkMax();\n\t\treturn addedItem;\n\t}\n\n\t/**\n\t * You might want to use canAdd before to ensure the item is valid\n\t * @param {string} text\n\t * @param {string} value\n\t * @param {object} data\n\t * @return {HTMLOptionElement} The created or selected option\n\t */\n\taddItem(text, value = null, data = {}) {\n\t\t// No value provided\n\t\tif (!value) {\n\t\t\tvalue = text;\n\t\t}\n\n\t\t// Single items remove first\n\t\tif (this.isSingle() && this.getSelectedValues().length) {\n\t\t\tthis.removeLastItem(true);\n\t\t}\n\n\t\tlet opt = this._findOption(value, \":not([selected])\");\n\n\t\t// we need to create a new option\n\t\tif (!opt) {\n\t\t\topt = ce(\"option\");\n\t\t\topt.value = value;\n\t\t\topt.innerText = text;\n\t\t\t// Pass along data provided\n\t\t\tfor (const [key, value] of Object.entries(data)) {\n\t\t\t\topt.dataset[key] = value;\n\t\t\t}\n\t\t\tthis._selectElement.appendChild(opt);\n\t\t\tthis._config.onCreateItem(opt, this);\n\t\t}\n\n\t\tif (opt) {\n\t\t\tdata = Object.assign(\n\t\t\t\t{\n\t\t\t\t\ttitle: opt.getAttribute(\"title\"),\n\t\t\t\t},\n\t\t\t\topt.dataset,\n\t\t\t\tdata,\n\t\t\t);\n\t\t}\n\t\t// update select, we need to set attribute for option[selected]\n\t\topt.setAttribute(\"selected\", \"selected\");\n\t\topt.selected = true;\n\n\t\tthis._createBadge(text, value, data);\n\n\t\t// Fire change event\n\t\tif (this._fireEvents) {\n\t\t\tthis._selectElement.dispatchEvent(new Event(\"change\", { bubbles: true }));\n\t\t}\n\n\t\treturn opt;\n\t}\n\n\t/**\n\t * mobile safari is doing it's own crazy thing...\n\t * without this, it wil not pick up the proper state of the select element and validation will fail\n\t */\n\t_resetHtmlState() {\n\t\tconst html = this._selectElement.innerHTML;\n\t\tthis._selectElement.innerHTML = \"\";\n\t\tthis._selectElement.innerHTML = html;\n\n\t\tthis._adjustWidth();\n\t}\n\n\t/**\n\t * @param {string} text\n\t * @param {string} value\n\t * @param {object} data\n\t */\n\t_createBadge(text, value = null, data = {}) {\n\t\tconst v5 = this._getBootstrapVersion() === 5;\n\t\tconst disabled = data.disabled && parseBool(data.disabled);\n\t\tconst allowClear = this._config.allowClear && !disabled;\n\n\t\t// create span\n\t\tlet html = this._config.allowHtml ? text : this._config.sanitizer(text);\n\n\t\t/**\n\t\t * @type {HTMLSpanElement}\n\t\t */\n\t\tconst span = ce(\"span\");\n\t\tlet classes = [`${CLASS_PREFIX}badge`];\n\n\t\tconst isSingle = this.isSingle() && !this._config.singleBadge;\n\n\t\tif (!isSingle) {\n\t\t\tclasses.push(\"badge\");\n\t\t\tlet badgeStyle = this._config.badgeStyle;\n\t\t\tif (data.badgeStyle) {\n\t\t\t\tbadgeStyle = data.badgeStyle;\n\t\t\t}\n\t\t\tif (data.badgeClass) {\n\t\t\t\tclasses.push(...data.badgeClass.split(\" \"));\n\t\t\t}\n\t\t\tif (this._config.baseClass) {\n\t\t\t\t// custom style\n\t\t\t\tclasses.push(...this._config.baseClass.split(\" \"));\n\t\t\t} else if (v5) {\n\t\t\t\t// https://getbootstrap.com/docs/5.3/components/badge/\n\t\t\t\tclasses = [...classes, ...[`bg-${badgeStyle}`], \"text-truncate\"];\n\t\t\t} else {\n\t\t\t\t// https://getbootstrap.com/docs/4.6/components/badge/\n\t\t\t\tclasses = [...classes, ...[`badge-${badgeStyle}`]];\n\t\t\t}\n\n\t\t\t// add extra styles to avoid any layout issues due to very large labels\n\t\t\tspan.style.maxWidth = \"100%\";\n\t\t}\n\n\t\tif (disabled) {\n\t\t\tclasses.push(...[\"disabled\", \"opacity-50\"]);\n\t\t}\n\n\t\tconst vertMargin = isSingle ? 0 : 2;\n\n\t\t// We cannot really rely on classes to get a proper sizing\n\t\tspan.style.margin = `${vertMargin}px 6px ${vertMargin}px 0px`;\n\t\t// Use logical styles for RTL support\n\t\tspan.style.marginBlock = `${vertMargin}px`;\n\t\tspan.style.marginInline = \"0px 6px\";\n\t\t// Required for some older browsers that don't inherit properly of holder flex styles\n\t\tspan.style.display = \"flex\";\n\t\tspan.style.alignItems = \"center\";\n\t\tif (data.backgroundColor) {\n\t\t\tspan.style.setProperty(\n\t\t\t\t\"background-color\",\n\t\t\t\tdata.backgroundColor,\n\t\t\t\t\"important\",\n\t\t\t);\n\t\t}\n\t\tif (data.color) {\n\t\t\tspan.style.setProperty(\"color\", data.color, \"important\");\n\t\t}\n\t\tspan.classList.add(...classes);\n\t\tspan.setAttribute(VALUE_ATTRIBUTE, value);\n\t\t// Tooltips\n\t\tif (data.title) {\n\t\t\tspan.setAttribute(\"title\", data.title);\n\t\t}\n\n\t\tif (allowClear) {\n\t\t\t// NOTE: we cannot use flex and align-item center because it disables text truncation\n\t\t\t// TODO: btn-close white is deprecated\n\t\t\t// @link https://getbootstrap.com/docs/5.3/components/close-button/\n\t\t\tconst closeClass =\n\t\t\t\tclasses.includes(\"text-dark\") ||\n\t\t\t\t(data.color && !hexIsLight(data.color)) ||\n\t\t\t\tisSingle\n\t\t\t\t\t? \"btn-close\"\n\t\t\t\t\t: \"btn-close btn-close-white\";\n\t\t\tlet btnMargin = \"margin-inline: 0px 6px;\";\n\t\t\tlet pos = \"left\";\n\t\t\tif (this._config.clearEnd) {\n\t\t\t\tpos = \"right\";\n\t\t\t}\n\t\t\tif (pos == \"right\") {\n\t\t\t\tbtnMargin = \"margin-inline: 6px 0px;\";\n\t\t\t}\n\t\t\tconst btn = v5\n\t\t\t\t? '<button type=\"button\" style=\"font-size:0.65em;' +\n\t\t\t\t\tbtnMargin +\n\t\t\t\t\t'\" class=\"' +\n\t\t\t\t\tcloseClass +\n\t\t\t\t\t'\" aria-label=\"' +\n\t\t\t\t\tthis._config.clearLabel +\n\t\t\t\t\t'\"></button>'\n\t\t\t\t: '<button type=\"button\" style=\"font-size:1em;' +\n\t\t\t\t\tbtnMargin +\n\t\t\t\t\t'text-shadow:none;color:currentColor;transform:scale(1.2);float:none\" class=\"close\" aria-label=\"' +\n\t\t\t\t\tthis._config.clearLabel +\n\t\t\t\t\t'\"><span aria-hidden=\"true\">&times;</span></button>';\n\n\t\t\t// rtl will follow logical html order\n\t\t\thtml = pos == \"left\" ? btn + html : html + btn;\n\t\t}\n\n\t\tspan.innerHTML = html;\n\t\tthis._containerElement.insertBefore(span, this._searchInput);\n\n\t\t// tooltips\n\t\tif (data.title && tooltip && v5) {\n\t\t\ttooltip.getOrCreateInstance(span);\n\t\t}\n\n\t\tif (allowClear) {\n\t\t\tspan.querySelector(\"button\").addEventListener(\"click\", (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\tthis._config\n\t\t\t\t\t\t.confirmClear(value, this)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.removeItem(value);\n\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\tdocument.activeElement.blur();\n\t\t\t\t\t\t\tthis._adjustWidth();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => {});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * @returns {HTMLDivElement}\n\t */\n\tgetHolder() {\n\t\treturn this._holderElement;\n\t}\n\n\tclear() {\n\t\tthis.hideSuggestions();\n\t\tthis.reset();\n\t}\n\n\t/**\n\t * Update data\n\t * @param {Array<Suggestion|SuggestionGroup>|Object} src An array of items or a value:label object\n\t */\n\tupdateData(src) {\n\t\tthis.setData(src, false);\n\t\tthis.reset();\n\t}\n\n\t/**\n\t * @param {string} value\n\t * @param {Boolean} value\n\t * @returns {Boolean}\n\t */\n\tremoveItem(value, noEvents = false) {\n\t\t// Remove badge if any\n\t\t// escape invalid characters for HTML attributes: \\' \" = < > ` &.'\n\t\tconst escapedValue = CSS.escape(value);\n\t\tconst items = this._containerElement.querySelectorAll(\n\t\t\t\"span[\" + VALUE_ATTRIBUTE + '=\"' + escapedValue + '\"]',\n\t\t);\n\t\tif (!items.length) {\n\t\t\treturn false;\n\t\t}\n\t\t// Remove the last entry for this value\n\t\tconst idx = items.length - 1;\n\t\tconst item = items[idx];\n\t\tif (item) {\n\t\t\tif (item.dataset.bsOriginalTitle) {\n\t\t\t\ttooltip.getOrCreateInstance(item).dispose();\n\t\t\t}\n\t\t\titem.remove();\n\t\t}\n\n\t\t// update select\n\t\tconst opt = this._findOption(value, \"[selected]\", idx);\n\t\tif (opt) {\n\t\t\trmAttr(opt, \"selected\");\n\t\t\topt.selected = false;\n\n\t\t\t// Fire change event\n\t\t\tif (this._fireEvents && !noEvents) {\n\t\t\t\tthis._selectElement.dispatchEvent(\n\t\t\t\t\tnew Event(\"change\", { bubbles: true }),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// Make input visible\n\t\tif (\n\t\t\tthis._searchInput.style.visibility == \"hidden\" &&\n\t\t\t!this.isMaxReached()\n\t\t) {\n\t\t\tthis._searchInput.style.visibility = \"visible\";\n\t\t\tthis._holderElement.classList.remove(MAX_REACHED_CLASS);\n\t\t}\n\n\t\tif (!noEvents) {\n\t\t\tthis._config.onClearItem(value, this);\n\t\t}\n\n\t\treturn true;\n\t}\n}\n\nexport default Tags;\n"],
  "mappings": "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",
  "names": ["DEFAULTS", "str", "sanitize", "item", "label", "inst", "value", "option", "event", "src", "text", "data", "response", "e", "signal", "CLASS_PREFIX", "LOADING_CLASS", "ACTIVE_CLASS", "INVALID_CLASS", "MAX_REACHED_CLASS", "SHOW_CLASS", "VALUE_ATTRIBUTE", "NEXT", "PREV", "FOCUS_CLASS", "PLACEHOLDER_CLASS", "DISABLED_CLASS", "INSTANCE_MAP", "counter", "tooltip", "debounce", "func", "timeout", "timer", "args", "calcTextWidth", "parent", "span", "ce", "width", "hexIsLight", "color", "hexColor", "r", "g", "b", "removeDiacritics", "normalize", "fuzzyMatch", "lookup", "pos", "c", "hideItem", "attrs", "showItem", "el", "k", "v", "rmAttr", "attr", "parseBool", "tagName", "splitMulti", "tokens", "tempChar", "s", "i", "nested", "obj", "p", "Tags", "config", "_selectElement", "_configure", "_isMouse", "_keyboardNavigation", "_searchFunc", "_loadFromServer", "_config", "_fireEvents", "_configureParent", "_holderElement", "_containerElement", "_dropElement", "_searchInput", "_configureHolderElement", "_configureContainerElement", "_configureSelectElement", "_configureSearchInput", "_configureDropElement", "ev", "_handleEvent", "type", "selector", "opts", "reset", "list", "_timer", "_findOption", "json", "o", "key", "defaultValue", "_getPlaceholder", "firstOption", "selectEl", "dropEl", "dropStyles", "holder", "className", "containerStyles", "searchInput", "_rtl", "related", "_abortController", "clearValidation", "_enterValue", "sel", "splitData", "n", "_addPastedValue", "addData", "_add", "lastChar", "_adjustWidth", "target", "_moveSelection", "lastItem", "_positionMenu", "init", "_setSelectedAttributes", "selectedOptions", "j", "convertOption", "convertedOption", "suggestions", "selection", "show", "extraParams", "params", "input", "inputName", "urlParams", "url", "fetchOptions", "_showSuggestions", "_resetHtmlState", "_isItemEnabled", "li", "fc", "dir", "active", "sibling", "_activeClasses", "selHeight", "selTop", "parentHeight", "parentScrollHeight", "parentTop", "scrollTop", "a", "w", "_buildSuggestions", "idx", "groupId", "suggestion", "newChild", "newChildSpan", "groupSuggestion", "_buildSuggestionsItem", "notFound", "textContent", "newChildLink", "searchData", "sf", "v5", "_getBootstrapVersion", "_removeSelectedAttrs", "opt", "iv", "_checkMax", "_shouldShow", "selected", "check", "valueCounter", "count", "firstItem", "hasPossibleValues", "visibleGroups", "link", "showAllSuggestions", "isMatched", "found", "selectFirst", "highlighted", "notFoundMessage", "_showDropdown", "isVisible", "wasVisible", "isRTL", "fixed", "fullWidth", "bounds", "holderBounds", "left", "top", "hdiff", "dropBounds", "h", "topOffset", "ver", "jq", "_isSelected", "_isSelectable", "arr", "items", "si", "_validateRegex", "res", "noEvents", "reason", "added", "mode", "addedItem", "_createBadge", "html", "disabled", "allowClear", "classes", "isSingle", "badgeStyle", "vertMargin", "closeClass", "btnMargin", "btn", "escapedValue", "tags_default"]
}
